<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#FFC107">
    <title>ë™ê´‘êµíšŒ 60ì£¼ë…„ ì˜¨ë¼ì¸ ì„±ê²½í€´ì¦ˆëŒ€íšŒ</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700;900&display=swap" rel="stylesheet">
    <!-- Firebase SDK (v9 compat) -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <!-- Firebase Hosting ìë™ ì„¤ì • (API í‚¤ë¥¼ ì†ŒìŠ¤ì½”ë“œì— ë…¸ì¶œí•˜ì§€ ì•ŠìŒ) -->
    <script src="/__/firebase/init.js"></script>
    <style>
        :root {
            --primary-yellow: #FFC107;
            --primary-dark: #222222;
            --accent-red: #E53935;
            --gradient-main: linear-gradient(135deg, #FFC107 0%, #FF9800 50%, #E53935 100%);
            --text-dark: #222222;
            --text-light: #ffffff;
            --bg-yellow: #FFD740;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #FFF8E1;
            color: var(--text-dark);
            line-height: 1.6;
        }

        /* ë ˆì´ì•„ì›ƒ ì»¨í…Œì´ë„ˆ */
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* í—¤ë” & ë¡œê³  */
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        .logo-img {
            max-width: 200px;
            height: auto;
            margin-bottom: 8px;
        }
        .title {
            font-size: 1.6rem;
            font-weight: 900;
            color: var(--primary-dark);
            margin-bottom: 4px;
        }
        .subtitle {
            font-size: 0.9rem;
            color: #666;
        }

        /* ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .card {
            background: white;
            border-radius: 24px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
            padding: 30px;
            text-align: center;
            transition: transform 0.3s ease;
            border: 3px solid transparent;
        }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
        }
        .btn-primary {
            background: var(--primary-dark);
            color: var(--primary-yellow);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            font-weight: 900;
        }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0,0,0,0.4); }
        .btn-option {
            background: #fff;
            border: 3px solid #eee;
            color: var(--text-dark);
            font-weight: 700;
        }
        .btn-option:hover {
            border-color: var(--primary-yellow);
            background: #FFFDE7;
        }

        /* í€´ì¦ˆ í™”ë©´ ìš”ì†Œ */
        .hidden { display: none; }
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #ddd;
            border-radius: 5px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: var(--gradient-main);
            width: 0%;
            transition: width 0.3s ease;
        }
        .question-text {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 25px;
            word-break: keep-all;
        }
        .input-answer {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1rem;
            margin-bottom: 15px;
        }
        .badge {
            display: inline-block;
            padding: 5px 10px;
            background-color: #eee;
            border-radius: 15px;
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 10px;
        }

        /* íƒ€ì´ë¨¸ ë°” */
        .timer-bar {
            width: 100%;
            height: 8px;
            background: #eee;
            border-radius: 4px;
            margin-bottom: 15px;
            overflow: hidden;
        }
        .timer-fill {
            height: 100%;
            width: 100%;
            border-radius: 4px;
            transition: background 0.3s;
        }
        .timer-fill.green { background: #4CAF50; }
        .timer-fill.yellow { background: #FF9800; }
        .timer-fill.red { background: #F44336; }
        .timer-text {
            font-size: 1.4rem;
            font-weight: 800;
            margin-bottom: 5px;
            transition: color 0.3s;
        }
        .timer-text.green { color: #4CAF50; }
        .timer-text.yellow { color: #FF9800; }
        .timer-text.red { color: #F44336; animation: pulse 0.5s infinite; }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        /* í€´ì¦ˆ HUD (ëª©ìˆ¨ + ì ìˆ˜) */
        .quiz-hud {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px 5px;
        }
        .hud-lives {
            font-size: 1.5rem;
            letter-spacing: 4px;
            transition: all 0.3s;
        }
        .hud-score {
            font-size: 1.1rem;
            font-weight: 900;
            color: var(--primary-dark);
        }
        .hud-streak {
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--accent-red);
            min-height: 20px;
        }

        /* ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-12px); }
            40% { transform: translateX(12px); }
            60% { transform: translateX(-8px); }
            80% { transform: translateX(8px); }
        }
        @keyframes popIn {
            0% { transform: scale(0.3); opacity: 0; }
            60% { transform: scale(1.15); }
            100% { transform: scale(1); opacity: 1; }
        }
        @keyframes heartBreak {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.3); color: #F44336; }
            100% { transform: scale(0); opacity: 0; }
        }
        @keyframes scoreUp {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            50% { transform: translateY(-25px) scale(1.3); opacity: 1; }
            100% { transform: translateY(-60px) scale(0.8); opacity: 0; }
        }
        @keyframes slideUp {
            0% { transform: translateY(30px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }
        @keyframes slideInLeft {
            0% { transform: translateX(-40px); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }
        @keyframes correctFlash {
            0% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.6); }
            50% { box-shadow: 0 0 30px 10px rgba(76, 175, 80, 0.3); }
            100% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0); }
        }
        @keyframes wrongFlash {
            0% { box-shadow: 0 0 0 0 rgba(244, 67, 54, 0.6); }
            50% { box-shadow: 0 0 30px 10px rgba(244, 67, 54, 0.3); }
            100% { box-shadow: 0 0 0 0 rgba(244, 67, 54, 0); }
        }
        @keyframes streakFire {
            0% { transform: scale(0.5) rotate(-10deg); opacity: 0; }
            50% { transform: scale(1.3) rotate(5deg); opacity: 1; }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
        @keyframes countdownPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.4); color: #F44336; }
        }
        @keyframes celebrateBounce {
            0% { transform: translateY(0); }
            30% { transform: translateY(-20px); }
            50% { transform: translateY(0); }
            70% { transform: translateY(-10px); }
            100% { transform: translateY(0); }
        }
        @keyframes bgPulseGreen {
            0% { border-color: transparent; }
            50% { border-color: #4CAF50; }
            100% { border-color: transparent; }
        }
        @keyframes bgPulseRed {
            0% { border-color: transparent; }
            50% { border-color: #F44336; }
            100% { border-color: transparent; }
        }
        @keyframes confetti {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-100px) rotate(720deg); opacity: 0; }
        }
        @keyframes fadeInScale {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        @keyframes bounceIn {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }
        @keyframes glowPulse {
            0%, 100% { box-shadow: 0 0 5px rgba(255, 193, 7, 0.3); }
            50% { box-shadow: 0 0 25px rgba(255, 193, 7, 0.6); }
        }
        .shake { animation: shake 0.5s ease; }
        .pop-in { animation: popIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .slide-up { animation: slideUp 0.4s ease-out; }
        .slide-in-left { animation: slideInLeft 0.3s ease-out; }
        .correct-flash { animation: correctFlash 0.6s ease; }
        .wrong-flash { animation: wrongFlash 0.6s ease; }
        .streak-fire { animation: streakFire 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .countdown-pulse { animation: countdownPulse 0.5s ease; }
        .celebrate-bounce { animation: celebrateBounce 0.8s ease; }
        .bg-pulse-green { animation: bgPulseGreen 0.6s ease; }
        .bg-pulse-red { animation: bgPulseRed 0.6s ease; }
        .bounce-in { animation: bounceIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .fade-in-scale { animation: fadeInScale 0.4s ease-out; }

        .score-float {
            position: absolute;
            right: 20px;
            top: 50px;
            font-size: 1.4rem;
            font-weight: 900;
            color: #4CAF50;
            pointer-events: none;
            animation: scoreUp 1.2s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
            text-shadow: 0 2px 8px rgba(76, 175, 80, 0.3);
        }
        .score-float.big {
            font-size: 2rem;
            color: var(--accent-red);
            text-shadow: 0 2px 12px rgba(229, 57, 53, 0.4);
        }
        .quiz-card-wrapper {
            position: relative;
        }

        /* ìŠ¤íŠ¸ë¦­ ì˜¤ë²„ë ˆì´ */
        .streak-overlay {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            font-size: 3rem;
            font-weight: 900;
            color: var(--accent-red);
            text-shadow: 0 4px 20px rgba(229, 57, 53, 0.5);
            pointer-events: none;
            z-index: 1000;
            animation: bounceIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards,
                       fadeOut 0.4s ease 1.2s forwards;
            white-space: nowrap;
        }
        @keyframes fadeOut {
            to { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
        }

        /* ë²„íŠ¼ í”„ë ˆìŠ¤ ì• ë‹ˆë©”ì´ì…˜ */
        .btn:active {
            transform: scale(0.95) !important;
            transition: transform 0.1s;
        }
        .btn-option {
            transition: all 0.2s ease, transform 0.1s;
        }
        .btn-option.option-enter {
            animation: slideInLeft 0.3s ease-out both;
        }

        /* í”¼ë“œë°± í…ìŠ¤íŠ¸ ì• ë‹ˆë©”ì´ì…˜ */
        .feedback-correct {
            animation: slideUp 0.3s ease-out;
        }
        .feedback-wrong {
            animation: slideUp 0.3s ease-out;
        }

        /* ë¬¸ì œ í…ìŠ¤íŠ¸ ì „í™˜ */
        .question-text.animate {
            animation: slideUp 0.4s ease-out;
        }

        /* ì¹´ë“œ ì „í™˜ */
        .card.card-enter {
            animation: fadeInScale 0.4s ease-out;
        }

        /* íŒŒí‹°í´ ì´í™íŠ¸ */
        .particle {
            position: fixed;
            pointer-events: none;
            z-index: 999;
            font-size: 1.5rem;
            animation: confetti 1s ease-out forwards;
        }

        /* HUD ê¸€ë¡œìš° */
        .hud-score.glow {
            animation: glowPulse 0.6s ease;
        }

        /* ê²Œì„ì˜¤ë²„ í™”ë©´ */
        .gameover-emoji {
            font-size: 4rem;
            margin: 15px 0;
        }
        .gameover-score {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--accent-red);
            margin: 10px 0;
        }

        /* ì…ë ¥ í¼ ìŠ¤íƒ€ì¼ */
        .form-group {
            text-align: left;
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            font-weight: 700;
            margin-bottom: 6px;
            color: var(--text-dark);
        }
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #ddd;
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Noto Sans KR', sans-serif;
            transition: border-color 0.2s;
            background-color: #fff;
        }
        select.form-input {
            -webkit-appearance: menulist;
            -moz-appearance: menulist;
            appearance: menulist;
            cursor: pointer;
            color: var(--text-dark);
            font-size: 16px;
        }
        .form-input:focus {
            outline: none;
            border-color: var(--primary-yellow);
        }
        .form-error {
            color: #F44336;
            font-size: 0.85rem;
            margin-top: 4px;
            display: none;
        }

        /* ê²°ê³¼ í™”ë©´ */
        .score-display {
            font-size: 3rem;
            font-weight: 900;
            color: var(--primary-dark);
            margin: 20px 0;
        }
        .feedback-correct { color: #4CAF50; font-weight: bold; margin-bottom: 10px; }
        .feedback-wrong { color: #F44336; font-weight: bold; margin-bottom: 10px; }
        .feedback-record { color: #FF6F00; font-size: 1.05em; animation: recordPulse 0.6s ease-in-out 2; }
        @keyframes recordPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* ê¸°ë¡ ê²½ì‹  íŒíŠ¸ */
        .record-hint {
            text-align: center;
            padding: 6px 14px;
            margin-bottom: 8px;
            border-radius: 20px;
            font-size: 0.82rem;
            background: linear-gradient(135deg, #FFF8E1, #FFECB3);
            color: #E65100;
            border: 1.5px solid #FFD54F;
            animation: hintSlide 0.4s ease-out;
        }
        .record-hint.hidden { display: none; }
        .record-hint.record-close {
            background: linear-gradient(135deg, #FFF3E0, #FFE0B2);
            border-color: #FF9800;
            animation: hintSlide 0.4s ease-out, hintGlow 1.5s ease-in-out infinite;
        }
        .record-hint.record-breaking {
            background: linear-gradient(135deg, #E8F5E9, #C8E6C9);
            color: #2E7D32;
            border-color: #66BB6A;
            animation: hintSlide 0.4s ease-out;
        }
        @keyframes hintSlide {
            from { opacity: 0; transform: translateY(-8px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes hintGlow {
            0%, 100% { box-shadow: 0 0 4px rgba(255,152,0,0.2); }
            50% { box-shadow: 0 0 12px rgba(255,152,0,0.5); }
        }

        /* ë¦¬ë”ë³´ë“œ */
        .leaderboard-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 0.95rem;
        }
        .leaderboard-table th {
            background: var(--primary-dark);
            color: var(--primary-yellow);
            padding: 10px 8px;
            font-weight: 900;
        }
        .leaderboard-table th:first-child { border-radius: 10px 0 0 0; }
        .leaderboard-table th:last-child { border-radius: 0 10px 0 0; }
        .leaderboard-table td {
            padding: 10px 8px;
            border-bottom: 1px solid #eee;
            text-align: center;
        }
        .leaderboard-table tr:hover td {
            background: #fff8e1;
        }
        .leaderboard-table .rank-1 td { background: #FFF8E1; font-weight: 900; }
        .leaderboard-table .rank-2 td { background: #f0f0f0; }
        .leaderboard-table .rank-3 td { background: #fde8d0; }
        .medal { font-size: 1.2rem; }
        .leaderboard-empty {
            color: #999;
            padding: 30px 0;
            font-size: 0.95rem;
        }
        .tab-container {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
        }
        .tab-btn {
            flex: 1;
            padding: 10px 8px;
            border: 2px solid #ddd;
            border-radius: 12px;
            background: #fff;
            font-size: 0.95rem;
            font-weight: 700;
            font-family: 'Noto Sans KR', sans-serif;
            color: #666;
            cursor: pointer;
            transition: all 0.2s;
        }
        .tab-btn.active {
            background: var(--primary-dark);
            color: var(--primary-yellow);
            border-color: var(--primary-dark);
        }
        .tab-btn:hover:not(.active) {
            border-color: var(--primary-yellow);
            background: #FFFDE7;
        }
        .btn-share {
            background: #25D366;
            color: #fff;
            border: none;
            font-weight: 900;
        }
        .btn-share:hover {
            background: #1DA851;
            transform: translateY(-2px);
        }
        #leaderboard-content {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        .btn-secondary {
            background: var(--primary-yellow);
            border: 2px solid var(--primary-yellow);
            color: var(--primary-dark);
            box-shadow: none;
            font-weight: 900;
        }
        .btn-secondary:hover {
            background: #FFD740;
            transform: translateY(-2px);
        }
        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        .btn-group .btn { flex: 1; }
        .church-logo {
            width: 50px;
            height: auto;
            vertical-align: middle;
            margin-right: 8px;
        }

        /* ë°°ì  ì•ˆë‚´ */
        .scoring-info {
            margin: 18px 0 8px;
            padding: 14px 16px;
            background: #f5f5f5;
            border-radius: 12px;
            text-align: center;
        }
        .scoring-info-title {
            font-size: 0.9rem;
            font-weight: 900;
            color: var(--primary-dark);
            margin-bottom: 6px;
        }
        .scoring-info p {
            font-size: 0.8rem;
            color: #666;
            margin: 3px 0;
            line-height: 1.5;
        }

        /* ì ìˆ˜ ë¹„êµ ë©”ì‹œì§€ */
        .score-comparison {
            margin: 12px auto;
            padding: 10px 18px;
            border-radius: 12px;
            font-size: 0.95rem;
            font-weight: 700;
            display: inline-block;
            animation: fadeInScale 0.5s ease-out;
        }
        .score-comparison.up {
            background: #e8f5e9;
            color: #2e7d32;
        }
        .score-comparison.same {
            background: #fff8e1;
            color: #f57f17;
        }
        .score-comparison.down {
            background: #f5f5f5;
            color: #757575;
        }
        .score-comparison.first {
            background: #e3f2fd;
            color: #1565c0;
        }

        /* ë¼ì´ë²Œ í† ìŠ¤íŠ¸ */
        .rival-toast {
            position: fixed;
            bottom: -80px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #222 0%, #444 100%);
            color: #fff;
            padding: 12px 24px;
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 700;
            white-space: nowrap;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            transition: bottom 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            max-width: 90vw;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .rival-toast.show {
            bottom: 30px;
        }

        /* í¬ìŠ¤í„° & ì‹œì‘í™”ë©´ */
        .poster-img {
            width: 100%;
            border-radius: 16px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        .event-info {
            background: #FFFDE7;
            border-radius: 14px;
            padding: 16px;
            margin: 15px 0;
            text-align: left;
            border-left: 5px solid var(--primary-yellow);
        }
        .event-info p {
            font-size: 0.9rem;
            margin: 6px 0;
            color: #444;
        }
        .event-info strong {
            color: var(--primary-dark);
        }
        .slogan {
            font-size: 1.05rem;
            font-weight: 900;
            color: var(--accent-red);
            margin: 15px 0;
            line-height: 1.8;
        }
        .start-title {
            font-size: 1.8rem;
            font-weight: 900;
            color: var(--primary-dark);
            margin-bottom: 5px;
        }
        .start-badge {
            display: inline-block;
            background: var(--primary-yellow);
            color: var(--primary-dark);
            padding: 4px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 900;
            margin-bottom: 12px;
        }
        .scope-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            justify-content: center;
            margin: 10px 0;
        }
        .scope-tag {
            background: var(--primary-dark);
            color: var(--primary-yellow);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
        }

        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• */
        @media (max-width: 480px) {
            .container {
                padding: 12px;
                justify-content: flex-start;
                padding-top: 10px;
            }
            header {
                margin-bottom: 15px;
            }
            .logo-img {
                max-width: 140px;
            }
            .title {
                font-size: 1.3rem;
            }
            .card {
                padding: 20px 16px;
                border-radius: 18px;
            }
            .poster-img {
                border-radius: 12px;
            }
            .start-title {
                font-size: 1.4rem;
            }
            .slogan {
                font-size: 0.95rem;
            }
            .event-info {
                padding: 12px;
            }
            .event-info p {
                font-size: 0.85rem;
            }
            .btn {
                padding: 13px;
                font-size: 1rem;
            }
            .question-text {
                font-size: 1.05rem;
                margin-bottom: 18px;
            }
            .btn-option {
                padding: 12px;
                font-size: 0.95rem;
            }
            .quiz-hud {
                margin-bottom: 10px;
                padding: 6px 2px;
            }
            .hud-lives {
                font-size: 1.2rem;
                letter-spacing: 2px;
            }
            .hud-score {
                font-size: 1rem;
            }
            .timer-text {
                font-size: 1.2rem;
            }
            .score-display {
                font-size: 2.5rem;
            }
            .gameover-score {
                font-size: 2rem;
            }
            .gameover-emoji {
                font-size: 3rem;
            }
            .leaderboard-table {
                font-size: 0.85rem;
            }
            .leaderboard-table th,
            .leaderboard-table td {
                padding: 8px 4px;
            }
            .btn-group {
                flex-direction: column;
            }
            .tab-btn {
                font-size: 0.85rem;
                padding: 8px 6px;
            }
        }

    </style>
</head>
<body>

<div class="container">
    <header>
        <img src="logo.png" alt="ë™ê´‘êµíšŒ 60ì£¼ë…„ ë¡œê³ " class="logo-img">
        <h1 class="title">ì „êµì¸ ì˜¨ë¼ì¸ ì„±ê²½í€´ì¦ˆëŒ€íšŒ</h1>
        <p class="subtitle">ë™ê´‘êµíšŒ ì°½ë¦½ 60ì£¼ë…„ ê¸°ë…</p>
    </header>

    <!-- 1. ì‹œì‘ í™”ë©´ -->
    <div id="start-screen" class="card">
        <img src="poster.jpg" alt="ì˜¨ë¼ì¸ ì„±ê²½í€´ì¦ˆëŒ€íšŒ í¬ìŠ¤í„°" class="poster-img">
        <div class="start-badge">ì°½ë¦½ 60ì£¼ë…„</div>
        <h2 class="start-title">ì˜¨ë¼ì¸ ì„±ê²½í€´ì¦ˆëŒ€íšŒ</h2>
        <div class="slogan">ì˜¤ì§ ë§ˆìŒ ë‹¤í•´<br>ì¹´ë¦¬ìŠ¤ë§ˆ ìˆê²Œ<br>ì„¸ìƒì„ ì •ë³µí•˜ë¼!</div>
        <div class="scope-tags">
            <span class="scope-tag">í•™ê°œ</span>
            <span class="scope-tag">ìŠ¤ê°€ë´</span>
            <span class="scope-tag">ì—ìŠ¤ë¼</span>
            <span class="scope-tag">ëŠí—¤ë¯¸ì•¼</span>
        </div>
        <div class="event-info">
            <p><strong>ì¼ì‹œ:</strong> 2026. 2. 22 (ì£¼ì¼) ì˜¤í›„ 5ì‹œ</p>
            <p><strong>ì¥ì†Œ:</strong> ì‚¬ë‘ì„±ì „ (ì£¼ì¼ ì˜¤í›„ì˜ˆë°°)</p>
            <p><strong>ëŒ€ìƒ:</strong> ì „êµì¸ (ìœ ì•„ë¶€~ì¥ë…„ë¶€)</p>
            <p><strong>ì‹œìƒ:</strong> íŒ€ë³„ì‹œìƒ, ê°œì¸ MVP ë“± í‘¸ì§í•œ ì„ ë¬¼</p>
        </div>
        <div class="scoring-info">
            <div class="scoring-info-title">ğŸ“Š ë°°ì  ì•ˆë‚´</div>
            <p>ë‚œì´ë„ í•˜ 100ì  Â· ì¤‘ 200ì  Â· ìƒ 300ì </p>
            <p>ğŸ”¥ ì—°ì† ì •ë‹µ ë³´ë„ˆìŠ¤: 2ì—°ì†ë¶€í„° ì—°ì† íšŸìˆ˜Ã—10ì  ì¶”ê°€ (ìµœëŒ€ +100ì )</p>
        </div>
        <button class="btn btn-primary" onclick="showRegister()">í€´ì¦ˆ ì°¸ê°€í•˜ê¸°</button>
        <button class="btn btn-secondary" style="margin-top:8px;" onclick="showLeaderboard()">ë¦¬ë”ë³´ë“œ ë³´ê¸°</button>
    </div>

    <!-- 2. ì†Œì†/ì´ë¦„ ì…ë ¥ í™”ë©´ -->
    <div id="register-screen" class="card hidden">
        <h2>ì°¸ê°€ì ë“±ë¡</h2>
        <p style="margin: 15px 0 20px; color: #666;">ì†Œì†ê³¼ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
        <div class="form-group">
            <label for="input-group">ì†Œì† (ë¶€ì„œ)</label>
            <select id="input-group" class="form-input">
                <option value="">-- ì†Œì†ì„ ì„ íƒí•˜ì„¸ìš” --</option>
                <optgroup label="êµìœ¡ë¶€ì„œ">
                    <option value="ìœ ì•„ë¶€(4.5ì„¸)">ìœ ì•„ë¶€(4.5ì„¸)</option>
                    <option value="ìœ ì¹˜ë¶€(6.7ì„¸)">ìœ ì¹˜ë¶€(6.7ì„¸)</option>
                    <option value="ìœ ë…„ë¶€(1.2í•™ë…„)">ìœ ë…„ë¶€(1.2í•™ë…„)</option>
                    <option value="ì´ˆë“±ë¶€(3.4í•™ë…„)">ì´ˆë“±ë¶€(3.4í•™ë…„)</option>
                    <option value="ì†Œë…„ë¶€(5.6í•™ë…„)">ì†Œë…„ë¶€(5.6í•™ë…„)</option>
                    <option value="ì¤‘ë“±ë¶€">ì¤‘ë“±ë¶€</option>
                    <option value="ê³ ë“±ë¶€">ê³ ë“±ë¶€</option>
                    <option value="ì²­ë…„ë¶€">ì²­ë…„ë¶€</option>
                </optgroup>
                <optgroup label="ë‚¨ì „ë„íšŒ">
                    <option value="1ë‚¨ì „ë„íšŒ">1ë‚¨ì „ë„íšŒ</option>
                    <option value="2ë‚¨ì „ë„íšŒ">2ë‚¨ì „ë„íšŒ</option>
                    <option value="3ë‚¨ì „ë„íšŒ">3ë‚¨ì „ë„íšŒ</option>
                    <option value="4ë‚¨ì „ë„íšŒ">4ë‚¨ì „ë„íšŒ</option>
                    <option value="5ë‚¨ì „ë„íšŒ">5ë‚¨ì „ë„íšŒ</option>
                    <option value="6ë‚¨ì „ë„íšŒ">6ë‚¨ì „ë„íšŒ</option>
                    <option value="7ë‚¨ì „ë„íšŒ">7ë‚¨ì „ë„íšŒ</option>
                    <option value="8ë‚¨ì „ë„íšŒ">8ë‚¨ì „ë„íšŒ</option>
                </optgroup>
                <optgroup label="ì—¬ì „ë„íšŒ">
                    <option value="1ì—¬ì „ë„íšŒ">1ì—¬ì „ë„íšŒ</option>
                    <option value="2ì—¬ì „ë„íšŒ">2ì—¬ì „ë„íšŒ</option>
                    <option value="3ì—¬ì „ë„íšŒ">3ì—¬ì „ë„íšŒ</option>
                    <option value="4ì—¬ì „ë„íšŒ">4ì—¬ì „ë„íšŒ</option>
                    <option value="5ì—¬ì „ë„íšŒ">5ì—¬ì „ë„íšŒ</option>
                    <option value="6ì—¬ì „ë„íšŒ">6ì—¬ì „ë„íšŒ</option>
                    <option value="7ì—¬ì „ë„íšŒ">7ì—¬ì „ë„íšŒ</option>
                    <option value="8ì—¬ì „ë„íšŒ">8ì—¬ì „ë„íšŒ</option>
                    <option value="9ì—¬ì „ë„íšŒ">9ì—¬ì „ë„íšŒ</option>
                    <option value="10ì—¬ì „ë„íšŒ">10ì—¬ì „ë„íšŒ</option>
                </optgroup>
            </select>
            <div class="form-error" id="error-group">ì†Œì†ì„ ì„ íƒí•´ì£¼ì„¸ìš”.</div>
        </div>
        <div class="form-group">
            <label for="input-name">ì´ë¦„</label>
            <input type="text" id="input-name" class="form-input" placeholder="ì˜ˆ: í™ê¸¸ë™">
            <div class="form-error" id="error-name">ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
        </div>
        <button class="btn btn-primary" onclick="startQuiz()">í€´ì¦ˆ ì‹œì‘í•˜ê¸°</button>
    </div>

    <div id="quiz-screen" class="card hidden quiz-card-wrapper">
        <div class="quiz-hud">
            <div class="hud-lives" id="hud-lives"></div>
            <div style="text-align:right;">
                <div class="hud-score" id="hud-score">0ì </div>
                <div class="hud-streak" id="hud-streak"></div>
            </div>
        </div>
        <div class="progress-bar"><div class="progress-fill" id="progress"></div></div>
        <div class="timer-text green" id="timer-text">15</div>
        <div class="timer-bar"><div class="timer-fill green" id="timer-fill"></div></div>
        <div id="record-hint" class="record-hint hidden"></div>
        <div class="badge" id="category-badge">ë‚œì´ë„: í•˜</div>
        <div class="question-text" id="question">ë¬¸ì œ ë‚´ìš©ì´ ì—¬ê¸°ì— ë‚˜ì˜µë‹ˆë‹¤.</div>

        <div id="options-container"></div>

        <div id="input-container" class="hidden">
            <input type="text" id="subjective-answer" class="input-answer" placeholder="ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš”">
            <button class="btn btn-primary" onclick="submitSubjective()">ì œì¶œ</button>
        </div>

        <div id="feedback" style="margin-top: 15px;"></div>
    </div>

    <div id="rival-toast" class="rival-toast"></div>

    <!-- ê²Œì„ì˜¤ë²„ í™”ë©´ -->
    <div id="gameover-screen" class="card hidden">
        <div class="gameover-emoji">ğŸ’”</div>
        <h2>ê²Œì„ ì˜¤ë²„!</h2>
        <p id="gameover-player-info"></p>
        <div class="gameover-score" id="gameover-score">0ì </div>
        <p style="color:#666; margin: 10px 0;">ëª©ìˆ¨ì„ ëª¨ë‘ ìƒì—ˆìŠµë‹ˆë‹¤!</p>
        <div id="gameover-comparison"></div>
        <p id="gameover-message"></p>
        <button class="btn btn-share" onclick="shareResult('gameover')">ê²°ê³¼ ê³µìœ í•˜ê¸°</button>
        <div class="btn-group">
            <button class="btn btn-primary" onclick="restartQuiz()">ë‹¤ì‹œ ë„ì „í•˜ê¸°</button>
            <button class="btn btn-secondary" onclick="showLeaderboard()">ë¦¬ë”ë³´ë“œ</button>
        </div>
    </div>

    <!-- 4. ê²°ê³¼ í™”ë©´ -->
    <div id="result-screen" class="card hidden">
        <h2>í€´ì¦ˆ ì¢…ë£Œ!</h2>
        <p id="result-player-info"></p>
        <div class="score-display" id="final-score">0ì </div>
        <div id="result-comparison"></div>
        <p id="result-message">ë§ì”€ ì•ˆì— ê±°í•˜ëŠ” ì‚¶, ì¶•ë³µí•©ë‹ˆë‹¤!</p>
        <button class="btn btn-share" onclick="shareResult('result')">ê²°ê³¼ ê³µìœ í•˜ê¸°</button>
        <div class="btn-group">
            <button class="btn btn-primary" onclick="restartQuiz()">ë‹¤ì‹œ ë„ì „í•˜ê¸°</button>
            <button class="btn btn-secondary" onclick="showLeaderboard()">ë¦¬ë”ë³´ë“œ</button>
        </div>
    </div>

    <!-- 5. ë¦¬ë”ë³´ë“œ í™”ë©´ -->
    <div id="leaderboard-screen" class="card hidden">
        <h2>ë¦¬ë”ë³´ë“œ</h2>
        <p style="margin: 10px 0 15px; color: #666;">ìƒìœ„ ê¸°ë¡ì„ í™•ì¸í•˜ì„¸ìš”!</p>
        <div class="tab-container">
            <button class="tab-btn active" onclick="switchTab('individual')">ê°œì¸ ìˆœìœ„</button>
            <button class="tab-btn" onclick="switchTab('department')">ë¶€ì„œ ëŒ€í•­ì „</button>
        </div>
        <div id="leaderboard-content"></div>
        <div id="department-content" class="hidden"></div>
        <button class="btn btn-primary" style="margin-top: 20px;" onclick="showStart()">ì²˜ìŒìœ¼ë¡œ</button>
    </div>
</div>

<script>
    // â”€â”€â”€ Firebase ì´ˆê¸°í™” â”€â”€â”€
    // Firebase Hostingì˜ /__/firebase/init.jsê°€ ìë™ìœ¼ë¡œ firebase.initializeApp()ì„ í˜¸ì¶œí•©ë‹ˆë‹¤.
    const db = firebase.firestore();

    // ë¬¸ì œ ë°ì´í„° (PDF ì›ë³¸ 80ë¬¸ì œ)
    const quizData = [
        // â”€â”€ í•™ê°œ (20ë¬¸ì œ) â”€â”€
        // í•˜
        { category:"í•™ê°œ", level:"í•˜", type:"subjective", question:"í•™ê°œ ì„ ì§€ìê°€ í•˜ë‚˜ë‹˜ì˜ ë§ì”€ì„ ì „í•  ë•Œ, ë‹¹ì‹œ ìœ ë‹¤ì˜ ì´ë…ì€ ëˆ„êµ¬ì˜€ìŠµë‹ˆê¹Œ?", answer:["ìŠ¤ë£¹ë°”ë²¨"], ref:"í•™ 1:1" },
        { category:"í•™ê°œ", level:"í•˜", type:"objective", question:"í•™ê°œ ì„ ì§€ìê°€ ì‚¬ì—­í•˜ë˜ ì‹œê¸°ì˜ ë°”ì‚¬(í˜ë¥´ì‹œì•„) ì™•ì€ ëˆ„êµ¬ì…ë‹ˆê¹Œ?", options:["ê³ ë ˆìŠ¤","ë‹¤ë¦¬ì˜¤","ì•„ë‹¥ì‚¬ìŠ¤ë‹¤","ì•„í•˜ìˆ˜ì—ë¡œ"], answer:1, ref:"í•™ 1:1" },
        { category:"í•™ê°œ", level:"í•˜", type:"subjective", question:"ë°±ì„±ë“¤ì´ ì„±ì „ ê±´ì¶•ì„ ë¯¸ë£° ë•Œ, ì •ì‘ ìì‹ ë“¤ì€ ì–´ë–¤ ì§‘ì— ê±°ì£¼í•˜ê³  ìˆì—ˆìŠµë‹ˆê¹Œ?", answer:["íŒë²½í•œ ì§‘","íŒë²½ì§‘","ì˜ ê¾¸ë©°ì§„ ì§‘"], ref:"í•™ 1:4" },
        { category:"í•™ê°œ", level:"í•˜", type:"subjective", question:"í•˜ë‚˜ë‹˜ê»˜ì„œ ë°±ì„±ë“¤ì—ê²Œ 'ë„ˆí¬ëŠ” ë„ˆí¬ì˜ ( )ë¥¼ ì‚´í•„ì§€ë‹ˆë¼'ë¼ê³  ë°˜ë³µí•˜ì…¨ìŠµë‹ˆë‹¤. ê´„í˜¸ ì•ˆì— ë“¤ì–´ê°ˆ ë‹¨ì–´ëŠ”?", answer:["í–‰ìœ„"], ref:"í•™ 1:5,7" },
        { category:"í•™ê°œ", level:"í•˜", type:"objective", question:"í•™ê°œì„œëŠ” ì´ ëª‡ ì¥ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆê¹Œ?", options:["1ì¥","2ì¥","3ì¥","12ì¥"], answer:1, ref:"í•™ê°œì„œ" },
        // ì¤‘
        { category:"í•™ê°œ", level:"ì¤‘", type:"subjective", question:"í•˜ë‚˜ë‹˜ì€ ë°±ì„±ë“¤ì—ê²Œ ì–´ë””ì— ì˜¬ë¼ê°€ì„œ ë‚˜ë¬´ë¥¼ ê°€ì ¸ë‹¤ê°€ ì„±ì „ì„ ê±´ì¶•í•˜ë¼ê³  ëª…ë ¹í•˜ì…¨ìŠµë‹ˆê¹Œ?", answer:["ì‚°"], ref:"í•™ 1:8" },
        { category:"í•™ê°œ", level:"ì¤‘", type:"objective", question:"ë°±ì„±ë“¤ì´ ì„±ì „ ì¬ê±´ì„ ì†Œí™€íˆ í•œ ê²°ê³¼ë¡œ ë‚˜íƒ€ë‚œ í˜„ìƒì´ ì•„ë‹Œ ê²ƒì€?", options:["ë§ì´ ë¿Œë¦´ì§€ë¼ë„ ìˆ˜í™•ì´ ì ìŒ","ë¨¹ì„ì§€ë¼ë„ ë°°ë¶€ë¥´ì§€ ëª»í•¨","ì…ì–´ë„ ë”°ëœ»í•˜ì§€ ëª»í•¨","ëŒ€ì ì˜ ì¹¨ê³µì„ ë°›ì•„ ì„±ìì´ ë¬´ë„ˆì§"], answer:3, ref:"í•™ 1:6" },
        { category:"í•™ê°œ", level:"ì¤‘", type:"subjective", question:"í•™ê°œì˜ ë…ë ¤ë¥¼ ë“£ê³  ì„±ì „ ê³µì‚¬ë¥¼ ì‹œì‘í•œ ìœ ë‹¤ì˜ ëŒ€ì œì‚¬ì¥ ì´ë¦„ì€?", answer:["ì—¬í˜¸ìˆ˜ì•„"], ref:"í•™ 1:12" },
        { category:"í•™ê°œ", level:"ì¤‘", type:"objective", question:"ì†”ë¡œëª¬ ì„±ì „ì˜ ì˜ê´‘ì„ ê¸°ì–µí•˜ëŠ” ë…¸ì¸ë“¤ì´ ìƒˆ ì„±ì „ì„ ë³´ì•˜ì„ ë•Œ ì–´ë–»ê²Œ ëŠê¼ˆìŠµë‹ˆê¹Œ?", options:["ë§¤ìš° ì›…ì¥í•´ ë³´ì˜€ë‹¤","ë³´ì˜ê²ƒì—†ì–´ ë³´ì˜€ë‹¤","í™©ê¸ˆë¹›ìœ¼ë¡œ ë¹›ë‚¬ë‹¤","ë¬´ì„œì›Œ ë³´ì˜€ë‹¤"], answer:1, ref:"í•™ 2:3" },
        { category:"í•™ê°œ", level:"ì¤‘", type:"subjective", question:"í•˜ë‚˜ë‹˜ê»˜ì„œ 'ì¡°ê¸ˆ ìˆìœ¼ë©´ ë‚´ê°€ í•˜ëŠ˜ê³¼ ë•…ê³¼ ë°”ë‹¤ì™€ ( )ë¥¼ ì§„ë™ì‹œí‚¬ ê²ƒì´ìš”'ë¼ê³  ë§ì”€í•˜ì…¨ìŠµë‹ˆë‹¤. ê´„í˜¸ ì•ˆì— ë“¤ì–´ê°ˆ ë‹¨ì–´ëŠ”?", answer:["ìœ¡ì§€"], ref:"í•™ 2:6" },
        { category:"í•™ê°œ", level:"ì¤‘", type:"subjective", question:"í•˜ë‚˜ë‹˜ê»˜ì„œ ì„±ì „ì„ ì¬ê±´í•˜ë©´ 'ì´ê³³ì— ( )ì„ ì£¼ë¦¬ë¼'ê³  ì•½ì†í•˜ì…¨ìŠµë‹ˆë‹¤. ê´„í˜¸ ì•ˆì— ë“¤ì–´ê°ˆ ë‹¨ì–´ëŠ”?", answer:["í‰ê°•"], ref:"í•™ 2:9" },
        { category:"í•™ê°œ", level:"ì¤‘", type:"objective", question:"í•™ê°œ 2ì¥ì—ì„œ ê±°ë£©í•œ ê³ ê¸°ë¥¼ ì‹¼ ì˜·ìë½ì´ ë‹¤ë¥¸ ìŒì‹ì— ë‹¿ìœ¼ë©´ ê·¸ ìŒì‹ì´ ì„±ë¬¼ì´ ë©ë‹ˆê¹Œ?", options:["ëœë‹¤","ì•ˆ ëœë‹¤","ìƒí™©ì— ë”°ë¼ ë‹¤ë¥´ë‹¤","ì•Œ ìˆ˜ ì—†ë‹¤"], answer:1, ref:"í•™ 2:12" },
        { category:"í•™ê°œ", level:"ì¤‘", type:"subjective", question:"ì‹œì²´ë¥¼ ë§Œì ¸ ë¶€ì •í•˜ì—¬ì§„ ìê°€ ë¬´ì—‡ì„ ë§Œì§€ë©´ ê·¸ê²ƒì´ ì–´ë–»ê²Œ ë©ë‹ˆê¹Œ?", answer:["ë¶€ì •í•˜ì—¬ì§„ë‹¤","ë¶€ì •í•´ì§„ë‹¤"], ref:"í•™ 2:13" },
        { category:"í•™ê°œ", level:"ì¤‘", type:"objective", question:"ì§€ëŒ€(ê¸°ì´ˆ)ë¥¼ ìŒ“ê¸° ì „ì—ëŠ” ì´ì‹­ ê³ ë¥´ ê³¡ì‹ ë”ë¯¸ì— ì´ë¥¸ì¦‰ ì‹¤ì œë¡œëŠ” ëª‡ ê³ ë¥´ë¿ì´ì—ˆìŠµë‹ˆê¹Œ?", options:["ì˜¤ ê³ ë¥´","ì‹­ ê³ ë¥´","ì‹­ì˜¤ ê³ ë¥´","ì´ì‹­ ê³ ë¥´"], answer:1, ref:"í•™ 2:16" },
        { category:"í•™ê°œ", level:"ì¤‘", type:"subjective", question:"í¬ë„ì¦™ í‹€ì—ì„œ ì˜¤ì‹­ ê³ ë¥´ë¥¼ ê¸¸ìœ¼ë ¤ í•œì¦‰ ì‹¤ì œë¡œëŠ” ëª‡ ê³ ë¥´ë¿ì´ì—ˆìŠµë‹ˆê¹Œ?", answer:["ì´ì‹­","ì´ì‹­ ê³ ë¥´","20","20ê³ ë¥´"], ref:"í•™ 2:16" },
        // ìƒ
        { category:"í•™ê°œ", level:"ìƒ", type:"subjective", question:"í•™ê°œ ì„ ì§€ìì—ê²Œ ì—¬í˜¸ì™€ì˜ ë§ì”€ì´ ì²˜ìŒ ì„í•œ ë‚ ì§œëŠ” êµ¬ì²´ì ìœ¼ë¡œ ì–¸ì œì…ë‹ˆê¹Œ?", answer:["ë‹¤ë¦¬ì˜¤ ì™• ì œì´ë…„ ì—¬ì„¯ì§¸ ë‹¬ ì´ˆí•˜ë£¨","ì—¬ì„¯ì§¸ ë‹¬ ì´ˆí•˜ë£¨","6ì›” 1ì¼"], ref:"í•™ 1:1" },
        { category:"í•™ê°œ", level:"ìƒ", type:"objective", question:"ë°±ì„±ë“¤ì´ ë§ˆìŒì´ ê°ë™ë˜ì–´ ì—¬í˜¸ì™€ì˜ ì „ ê³µì‚¬ë¥¼ ì‹¤ì œë¡œ ì‹œì‘í•œ ë‚ ì§œëŠ”?", options:["ì—¬ì„¯ì§¸ ë‹¬ ì´ì‹­ì‚¬ì¼","ì¼ê³±ì§¸ ë‹¬ ì´ì‹­ì¼ì¼","ì•„í™‰ì§¸ ë‹¬ ì´ì‹­ì‚¬ì¼","ì—´ì§¸ ë‹¬ ì´ˆí•˜ë£¨"], answer:0, ref:"í•™ 1:15" },
        { category:"í•™ê°œ", level:"ìƒ", type:"subjective", question:"í•˜ë‚˜ë‹˜ê»˜ì„œ 'ì˜¤ëŠ˜ë¶€í„°ëŠ” ë‚´ê°€ ë„ˆí¬ì—ê²Œ ë³µì„ ì£¼ë¦¬ë¼'ê³  ì„ í¬í•˜ì‹  ë‚ ì§œëŠ” ì•„í™‰ì§¸ ë‹¬ ë©°ì¹ ì…ë‹ˆê¹Œ?", answer:["ì´ì‹­ì‚¬ì¼","24ì¼"], ref:"í•™ 2:18-19" },
        { category:"í•™ê°œ", level:"ìƒ", type:"subjective", question:"í•™ê°œ 2:23ì—ì„œ í•˜ë‚˜ë‹˜ì€ ìŠ¤ë£¹ë°”ë²¨ì„ ë¬´ì—‡ìœ¼ë¡œ ì‚¼ê² ë‹¤ê³  ë§ì”€í•˜ì…¨ìŠµë‹ˆê¹Œ?", answer:["ì¸ì¥","ë„ì¥","ì¸"], ref:"í•™ 2:23" },
        { category:"í•™ê°œ", level:"ìƒ", type:"objective", question:"í•™ê°œì„œ 2ì¥ì—ì„œ ì—¬í˜¸ì™€ì˜ ë§ì”€ì´ ì„í•œ ì„¸ ë²ˆì§¸ ë‚ ì§œ(ì´ì „ ì˜ê´‘ì„ ë³¸ ìë“¤ì„ ìœ„ë¡œí•˜ì‹¤ ë•Œ)ëŠ”?", options:["ì—¬ì„¯ì§¸ ë‹¬ ì´ì‹­ì‚¬ì¼","ì¼ê³±ì§¸ ë‹¬ ì´ì‹­ì¼ì¼","ì•„í™‰ì§¸ ë‹¬ ì´ì‹­ì‚¬ì¼","ì—´ì§¸ ë‹¬ ì´ˆí•˜ë£¨"], answer:1, ref:"í•™ 2:1" },

        // â”€â”€ ìŠ¤ê°€ë´ (20ë¬¸ì œ) â”€â”€
        // í•˜
        { category:"ìŠ¤ê°€ë´", level:"í•˜", type:"subjective", question:"ìŠ¤ê°€ë´ ì„ ì§€ìëŠ” ëˆ„êµ¬ì˜ ì†ìì…ë‹ˆê¹Œ?", answer:["ì‡ë„"], ref:"ìŠ¥ 1:1" },
        { category:"ìŠ¤ê°€ë´", level:"í•˜", type:"objective", question:"ìŠ¤ê°€ë´ 3ì¥ì—ì„œ ëŒ€ì œì‚¬ì¥ ì—¬í˜¸ìˆ˜ì•„ì˜ ì˜¤ë¥¸ìª½ì— ì„œì„œ ëŒ€ì í•œ ì¡´ì¬ëŠ”?", options:["ê°€ë¸Œë¦¬ì—˜","ë¯¸ê°€ì—˜","ì‚¬íƒ„","ë²¨ë¦¬ì•Œ"], answer:2, ref:"ìŠ¥ 3:1" },
        { category:"ìŠ¤ê°€ë´", level:"í•˜", type:"subjective", question:"ìŠ¤ê°€ë´ì„œëŠ” ì´ ëª‡ ì¥ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆê¹Œ?", answer:["14","14ì¥","ì‹­ì‚¬ì¥"], ref:"ìŠ¤ê°€ë´ì„œ" },
        { category:"ìŠ¤ê°€ë´", level:"í•˜", type:"subjective", question:"'ì´ëŠ” í˜ìœ¼ë¡œ ë˜ì§€ ì•„ë‹ˆí•˜ë©° ëŠ¥ë ¥ìœ¼ë¡œ ë˜ì§€ ì•„ë‹ˆí•˜ê³  ì˜¤ì§ ë‚˜ì˜ ( )ìœ¼ë¡œ ë˜ëŠë‹ˆë¼' ê´„í˜¸ ì•ˆì— ë“¤ì–´ê°ˆ ë‹¨ì–´ëŠ”?", answer:["ì˜","ì‹ "], ref:"ìŠ¥ 4:6" },
        { category:"ìŠ¤ê°€ë´", level:"í•˜", type:"objective", question:"ìŠ¤ê°€ë´ 9ì¥ì—ì„œ ì˜ˆë£¨ì‚´ë ˜ì˜ ì™•ì´ ê²¸ì†í•˜ì—¬ì„œ íƒ€ê³  ì…ì„±í•˜ëŠ” ê²ƒì€?", options:["ë°±ë§ˆ","ë³‘ê±°","ë‚˜ê·€","ë‚™íƒ€"], answer:2, ref:"ìŠ¥ 9:9" },
        // ì¤‘
        { category:"ìŠ¤ê°€ë´", level:"ì¤‘", type:"subjective", question:"ìŠ¤ê°€ë´ê°€ ë³¸ ì²« ë²ˆì§¸ í™˜ìƒì—ì„œ, ê³¨ì§œê¸° ì† í™”ì„ë¥˜ë‚˜ë¬´ ì‚¬ì´ì— ì„  ìê°€ íƒ„ ë§ì˜ ìƒ‰ê¹”ì€?", answer:["ë¶‰ì€ìƒ‰","í™ë§ˆ","ë¶‰ì€","ë¹¨ê°„ìƒ‰","ë¹¨ê°„"], ref:"ìŠ¥ 1:8" },
        { category:"ìŠ¤ê°€ë´", level:"ì¤‘", type:"objective", question:"ìœ ë‹¤ì™€ ì´ìŠ¤ë¼ì—˜ì„ í©ëœ¨ë¦° 'ë„¤ ë¿”'ì„ ê²ì£¼ê¸° ìœ„í•´ ë“±ì¥í•œ ì‚¬ëŒë“¤ì€?", options:["ëŒ€ì¥ì¥ì´ ë„¤ ëª…","ì œì‚¬ì¥ ë„¤ ëª…","íŒŒìˆ˜ê¾¼ ë„¤ ëª…","ë†ë¶€ ë„¤ ëª…"], answer:0, ref:"ìŠ¥ 1:20" },
        { category:"ìŠ¤ê°€ë´", level:"ì¤‘", type:"subjective", question:"ì²œì‚¬ê°€ ëŒ€ì œì‚¬ì¥ ì—¬í˜¸ìˆ˜ì•„ì˜ ë”ëŸ¬ìš´ ì˜·ì„ ë²—ê¸°ê³  ë¬´ì—‡ì„ ì…í˜€ì£¼ì—ˆìŠµë‹ˆê¹Œ?", answer:["ì•„ë¦„ë‹¤ìš´ ì˜·"], ref:"ìŠ¥ 3:4" },
        { category:"ìŠ¤ê°€ë´", level:"ì¤‘", type:"objective", question:"ìŠ¤ê°€ë´ 4ì¥ì—ì„œ ìˆœê¸ˆ ë“±ì”ëŒ€ ê³ì˜ 'ë‘ ê°ëŒë‚˜ë¬´'ëŠ” ë¬´ì—‡ì„ ìƒì§•í•©ë‹ˆê¹Œ?", options:["ë‘ ì²œì‚¬","ê¸°ë¦„ ë¶€ìŒ ë°›ì€ ì ë‘˜","ì´ìŠ¤ë¼ì—˜ê³¼ ìœ ë‹¤","êµ¬ì•½ê³¼ ì‹ ì•½"], answer:1, ref:"ìŠ¥ 4:14" },
        { category:"ìŠ¤ê°€ë´", level:"ì¤‘", type:"subjective", question:"ë‚ ì•„ê°€ëŠ” ë‘ë£¨ë§ˆë¦¬ í™˜ìƒì—ì„œ ê·¸ ë‘ë£¨ë§ˆë¦¬ì˜ ë„ˆë¹„ëŠ” ëª‡ ê·œë¹—ì…ë‹ˆê¹Œ?", answer:["ì‹­ ê·œë¹—","10ê·œë¹—","10","ì‹­"], ref:"ìŠ¥ 5:2" },
        { category:"ìŠ¤ê°€ë´", level:"ì¤‘", type:"objective", question:"ì—ë°”(ê³¡ì‹ ì¸¡ì • ìš©ê¸°) ì†ì— ì•‰ì•„ ìˆëŠ” ì—¬ì¸ì˜ ì´ë¦„ì€?", options:["ì§ˆíˆ¬","íƒìš•","êµë§Œ","ì•…"], answer:3, ref:"ìŠ¥ 5:8" },
        { category:"ìŠ¤ê°€ë´", level:"ì¤‘", type:"subjective", question:"ë„¤ ë³‘ê±° í™˜ìƒ ì¤‘, ë„·ì§¸ ë³‘ê±°ì— ë§¤ì—¬ ìˆë˜ ë§ë“¤ì€ ì–´ë–¤ ë§ì…ë‹ˆê¹Œ?", answer:["ì–´ë¡±ì§€ê³  ê±´ì¥í•œ ë§","ì–´ë¡±ì§„ ë§","ê±´ì¥í•œ ë§"], ref:"ìŠ¥ 6:3" },
        { category:"ìŠ¤ê°€ë´", level:"ì¤‘", type:"subjective", question:"ìŠ¤ê°€ë´ ì„ ì§€ìê°€ ì–‘ ë–¼ë¥¼ ë¨¹ì´ê¸° ìœ„í•´ ì·¨í•œ ë‘ ë§‰ëŒ€ê¸°ì˜ ì´ë¦„ì€?", answer:["ì€ì´ê³¼ ì—°í•©","ì€ì´, ì—°í•©","ì€ì´ ì—°í•©"], ref:"ìŠ¥ 11:7" },
        { category:"ìŠ¤ê°€ë´", level:"ì¤‘", type:"objective", question:"ë²§ì—˜ ì‚¬ëŒë“¤ì´ 'ìš°ë¦¬ê°€ ì—¬ëŸ¬ í•´ ë™ì•ˆ í–‰í•œ ëŒ€ë¡œ ëª‡ ì›”ì— ìš¸ë©° ê·¼ì‹ í•˜ë¦¬ì´ê¹Œ'ë¼ê³  ë¬¼ì—ˆìŠµë‹ˆê¹Œ?", options:["ì˜¤ì›”","ì¹ ì›”","êµ¬ì›”","ì‹œì›”"], answer:0, ref:"ìŠ¥ 7:3" },
        { category:"ìŠ¤ê°€ë´", level:"ì¤‘", type:"objective", question:"ìŠ¤ê°€ë´ 14ì¥ì—ì„œ ì´ë°© ë‚˜ë¼ë“¤ì´ ë§¤ë…„ ì˜ˆë£¨ì‚´ë ˜ì— ì˜¬ë¼ì™€ ì§€ì¼œì•¼ í•  ì ˆê¸°ëŠ”?", options:["ìœ ì›”ì ˆ","ì¹ ì¹ ì ˆ","ì´ˆë§‰ì ˆ","ìˆ˜ì¥ì ˆ"], answer:2, ref:"ìŠ¥ 14:16" },
        // ìƒ
        { category:"ìŠ¤ê°€ë´", level:"ìƒ", type:"subjective", question:"ìŠ¤ê°€ë´ ì„ ì§€ìì—ê²Œ ì—¬í˜¸ì™€ì˜ ë§ì”€ì´ ì²˜ìŒ ì„í•œ ë•ŒëŠ” ë‹¤ë¦¬ì˜¤ ì™• ì œì´ë…„ ëª‡ì§¸ ë‹¬ì…ë‹ˆê¹Œ?", answer:["ì—¬ëŸì§¸ ë‹¬","8ì›”","íŒ”ì›”","8","8ë²ˆì§¸ ë‹¬","8ì§¸ ë‹¬"], ref:"ìŠ¥ 1:1" },
        { category:"ìŠ¤ê°€ë´", level:"ìƒ", type:"objective", question:"ìŠ¤ê°€ë´ê°€ ì—¬ëŸ ê°€ì§€ í™˜ìƒì„ í•˜ë£»ë°¤ì— ëª¨ë‘ ë³¸ ë‚ ì§œëŠ”?", options:["ì—¬ëŸì§¸ ë‹¬ ì´ˆí•˜ë£¨","ì•„í™‰ì§¸ ë‹¬ ì´ì‹­ì‚¬ì¼","ì—´í•œì§¸ ë‹¬ ì´ì‹­ì‚¬ì¼","ì—´ì§¸ ë‹¬ ì‹­ì¼"], answer:2, ref:"ìŠ¥ 1:7" },
        { category:"ìŠ¤ê°€ë´", level:"ìƒ", type:"subjective", question:"ë°”ë²¨ë¡ ì—ì„œ ëŒì•„ì˜¨ ìë“¤ì´ ë‚¸ ì€ê³¼ ê¸ˆìœ¼ë¡œ ê´€ì„ ë§Œë“¤ì–´ ëˆ„êµ¬ì˜ ë¨¸ë¦¬ì— ì”Œì› ìŠµë‹ˆê¹Œ?", answer:["ì—¬í˜¸ìˆ˜ì•„","ëŒ€ì œì‚¬ì¥ ì—¬í˜¸ìˆ˜ì•„"], ref:"ìŠ¥ 6:11" },
        { category:"ìŠ¤ê°€ë´", level:"ìƒ", type:"subjective", question:"ì„ ì§€ìê°€ ìì‹ ì˜ í’ˆì‚¯ìœ¼ë¡œ ë°›ì€ ì€ì˜ ê°œìˆ˜ëŠ” ëª‡ ê°œì…ë‹ˆê¹Œ?", answer:["ì‚¼ì‹­","30","ì‚¼ì‹­ ê°œ","30ê°œ"], ref:"ìŠ¥ 11:12" },
        { category:"ìŠ¤ê°€ë´", level:"ìƒ", type:"objective", question:"í•˜ë‚˜ë‹˜ê»˜ì„œ 'ì˜ˆë£¨ì‚´ë ˜ì´ ì§„ë¦¬ì˜ ì„±ìì´ë¼ ì¼ì»¬ìŒì„ ë°›ê² ë‹¤'ê³  ë§ì”€í•˜ì‹  ë•ŒëŠ” ë‹¤ë¦¬ì˜¤ ì™• ì œì‚¬ë…„ ì•„í™‰ì§¸ ë‹¬ ë©°ì¹ ì…ë‹ˆê¹Œ?", options:["ì´ˆí•˜ë£¨","ì‚¬ì¼","ì‹­ì‚¬ì¼","ì´ì‹­ì‚¬ì¼"], answer:1, ref:"ìŠ¥ 7:1" },

        // â”€â”€ ì—ìŠ¤ë¼ (20ë¬¸ì œ) â”€â”€
        // í•˜
        { category:"ì—ìŠ¤ë¼", level:"í•˜", type:"objective", question:"ë°”ì‚¬ ì™• ê³ ë ˆìŠ¤ê°€ ì„±ì „ ê±´ì¶• ì¡°ì„œë¥¼ ë‚´ë¦° ë•ŒëŠ” ê·¸ì˜ í†µì¹˜ ì œ ëª‡ ë…„ì…ë‹ˆê¹Œ?", options:["ì œ1ë…„","ì œ3ë…„","ì œ7ë…„","ì œ10ë…„"], answer:0, ref:"ì— 1:1" },
        { category:"ì—ìŠ¤ë¼", level:"í•˜", type:"subjective", question:"í¬ë¡œì—ì„œ ëŒì•„ì˜¨ ë°±ì„±ë“¤ì´ ì œë‹¨ì„ ë§Œë“¤ê³  ê°€ì¥ ë¨¼ì € ì§€í‚¨ ì ˆê¸°ëŠ”?", answer:["ì´ˆë§‰ì ˆ"], ref:"ì— 3:4" },
        { category:"ì—ìŠ¤ë¼", level:"í•˜", type:"subjective", question:"í•™ì‚¬ ì—ìŠ¤ë¼ëŠ” ì´ìŠ¤ë¼ì—˜ì˜ ì²« ëŒ€ì œì‚¬ì¥ì´ì—ˆë˜ ëˆ„êµ¬ì˜ í›„ì†ì…ë‹ˆê¹Œ?", answer:["ì•„ë¡ "], ref:"ì— 7:1-5" },
        { category:"ì—ìŠ¤ë¼", level:"í•˜", type:"subjective", question:"ì—ìŠ¤ë¼ê°€ ê°€ì¡Œë˜ ë‘ ê°€ì§€ ì‹ ë¶„(ì§ë¶„)ì€ ë¬´ì—‡ì…ë‹ˆê¹Œ?", answer:["ì œì‚¬ì¥ê³¼ í•™ì‚¬","ì œì‚¬ì¥, í•™ì‚¬","ì œì‚¬ì¥ í•™ì‚¬"], ref:"ì— 7:11" },
        { category:"ì—ìŠ¤ë¼", level:"í•˜", type:"objective", question:"ì„±ì „ ê±´ì¶•ì„ ë°©í•´í•˜ë˜ ì‚¬ëŒë“¤ì´ ê¸€ì„ ì˜¬ë ¤ ê³µì‚¬ë¥¼ ì¤‘ë‹¨ì‹œí‚¨ ë°”ì‚¬ì˜ ì™•ì€?", options:["ê³ ë ˆìŠ¤","ë‹¤ë¦¬ì˜¤","ì•„ë‹¥ì‚¬ìŠ¤ë‹¤","ì•„í•˜ìˆ˜ì—ë¡œ"], answer:2, ref:"ì— 4:7,23-24" },
        // ì¤‘
        { category:"ì—ìŠ¤ë¼", level:"ì¤‘", type:"subjective", question:"ì œ1ì°¨ í¬ë¡œ ê·€í™˜ ë•Œ ì´ë…ìœ¼ë¡œ ì„ëª…ë˜ì–´ ì„±ì „ ê¸°êµ¬ë“¤ì„ ì¸ê³„ë°›ì€ ì¸ë¬¼ì€?", answer:["ì„¸ìŠ¤ë°”ì‚´"], ref:"ì— 1:8,5:14" },
        { category:"ì—ìŠ¤ë¼", level:"ì¤‘", type:"objective", question:"ì„±ì „ ì§€ëŒ€(ê¸°ì´ˆ)ë¥¼ ë†“ì„ ë•Œ, ì œì‚¬ì¥ë“¤ì´ ì˜ˆë³µì„ ì…ê³  ë“¤ê³  ì„œì„œ ì—¬í˜¸ì™€ë¥¼ ì°¬ì†¡í•œ ê²ƒì€?", options:["ë‚˜íŒ”","ìˆ˜ê¸ˆ","ë¹„íŒŒ","ì œê¸ˆ"], answer:0, ref:"ì— 3:10" },
        { category:"ì—ìŠ¤ë¼", level:"ì¤‘", type:"subjective", question:"ëŒ€ì ë“¤ì˜ ë°©í•´ë¡œ ì¤‘ë‹¨ë˜ì—ˆë˜ ì„±ì „ ê³µì‚¬ê°€ ë‹¤ì‹œ ì‹œì‘ëœ ê²ƒì€ ì–´ëŠ ì™•ì´ ì¦‰ìœ„í•œ í›„ì…ë‹ˆê¹Œ?", answer:["ë‹¤ë¦¬ì˜¤","ë‹¤ë¦¬ì˜¤ ì™•"], ref:"ì— 4:5" },
        { category:"ì—ìŠ¤ë¼", level:"ì¤‘", type:"objective", question:"ì„±ì „ì´ ì™„ê³µëœ ë‚ ì€ ë‹¤ë¦¬ì˜¤ ì™• ì œ6ë…„ ëª‡ ì›” ë©°ì¹ ì…ë‹ˆê¹Œ?", options:["ì •ì›” ì‹­ì‚¬ì¼","ì´ì›” ì‹­ì¼","ì•„ë‹¬ì›” ì‚¼ì¼","ê¸°ìŠ¬ë˜ì›” ì‚¬ì¼"], answer:2, ref:"ì— 6:15" },
        { category:"ì—ìŠ¤ë¼", level:"ì¤‘", type:"subjective", question:"ì—ìŠ¤ë¼ê°€ ì™•ì—ê²Œ ë¬´ì—‡ì´ë“  ë°›ì„ ìˆ˜ ìˆì—ˆë˜ ì´ìœ ëŠ” ì„±ê²½ì—ì„œ ë¬´ì—‡ì´ë¼ ì„¤ëª…í•©ë‹ˆê¹Œ?", answer:["í•˜ë‚˜ë‹˜ ì—¬í˜¸ì™€ì˜ ë„ìš°ì‹¬","ì—¬í˜¸ì™€ í•˜ë‚˜ë‹˜ì˜ ë„ìš°ì‹¬","ì—¬í˜¸ì™€ì˜ ë„ìš°ì‹¬","í•˜ë‚˜ë‹˜ì˜ ë„ìš°ì‹¬"], ref:"ì— 7:6" },
        { category:"ì—ìŠ¤ë¼", level:"ì¤‘", type:"objective", question:"ì—ìŠ¤ë¼ê°€ ì•„í•˜ì™€ ê°•ê°€ì—ì„œ ê¸ˆì‹í•˜ë©° ê¸°ë„í•œ ì´ìœ ëŠ”?", options:["ì–‘ì‹ì´ ë¶€ì¡±í•´ì„œ","ë³´ë³‘ê³¼ ë§ˆë³‘ì„ ì™•ì—ê²Œ êµ¬í•˜ê¸° ë¶€ë„ëŸ¬ì›Œì„œ","ë¹„ê°€ ë„ˆë¬´ ë§ì´ ì™€ì„œ","ì „ì—¼ë³‘ì´ ëŒì•„ì„œ"], answer:1, ref:"ì— 8:22" },
        { category:"ì—ìŠ¤ë¼", level:"ì¤‘", type:"subjective", question:"ì—ìŠ¤ë¼ê°€ ë°±ì„±ë“¤ì˜ ì´ë°© í†µí˜¼ ì†Œì‹ì„ ë“£ê³  ì·¨í•œ ì²« ë²ˆì§¸ í–‰ë™ì€?", answer:["ì†ì˜·ê³¼ ê²‰ì˜·ì„ ì°¢ê³ ","ê²‰ì˜·ê³¼ ì†ì˜·ì„ ì°¢ê³ ","ì†ì˜·ê³¼ ê²‰ì˜·ì„ ì°¢ì—ˆë‹¤","ê²‰ì˜·ê³¼ ì†ì˜·ì„ ì°¢ì—ˆë‹¤","ì˜·ì„ ì°¢ê³ ","ì˜·ì„ ì°¢ìŒ","ì˜·ì„ ì°¢ì—ˆë‹¤"], ref:"ì— 9:3" },
        { category:"ì—ìŠ¤ë¼", level:"ì¤‘", type:"objective", question:"ì´ë°© ì—¬ì¸ê³¼ ê²°í˜¼í•œ ì£„ë¥¼ íšŒê°œí•˜ê¸° ìœ„í•´ ëª¨ì¸ ë°±ì„±ë“¤ì´ ë–¨ê³  ìˆì—ˆë˜ ì´ìœ ëŠ” 'ì´ ì¼' ë•Œë¬¸ê³¼ ë˜ ë¬´ì—‡ ë•Œë¬¸?", options:["ë°°ê³ í””","í° ë¹„","ì¶”ìœ„","ëŒ€ì ì˜ ì¹¨ê³µ"], answer:1, ref:"ì— 10:9" },
        { category:"ì—ìŠ¤ë¼", level:"ì¤‘", type:"subjective", question:"ì´ë°© ì—¬ì¸ê³¼ ê²°í˜¼í•œ ìë“¤ì„ ì¡°ì‚¬í•˜ì—¬ ì¼ì„ ë§ˆë¬´ë¦¬í•˜ëŠ” ë° ê±¸ë¦° ê¸°ê°„ì€?", answer:["ì„ ë‹¬","3ê°œì›”","ì‚¼ ê°œì›”"], ref:"ì— 10:16-17" },
        { category:"ì—ìŠ¤ë¼", level:"ì¤‘", type:"subjective", question:"ì„±ì „ ë´‰í—Œì‹ì„ ë§ˆì¹œ í›„ ì •ì›” ì‹­ì‚¬ì¼ì— ë°±ì„±ë“¤ì´ ì§€í‚¨ ì ˆê¸°ëŠ”?", answer:["ìœ ì›”ì ˆ"], ref:"ì— 6:19" },
        // ìƒ
        { category:"ì—ìŠ¤ë¼", level:"ìƒ", type:"objective", question:"ê³ ë ˆìŠ¤ ì™•ì´ ë‚´ì–´ì¤€ ì„±ì „ ê¸°ëª… ì¤‘ 'ê¸ˆ ì ‘ì‹œ'ì˜ ê°œìˆ˜ëŠ”?", options:["10ê°œ","30ê°œ","100ê°œ","1,000ê°œ"], answer:1, ref:"ì— 1:9" },
        { category:"ì—ìŠ¤ë¼", level:"ìƒ", type:"subjective", question:"ì œ1ì°¨ í¬ë¡œ ê·€í™˜ ë•Œ ëŒì•„ì˜¨ ì „ì²´ íšŒì¤‘ì˜ í•©ê³„ëŠ” ì´ ëª‡ ëª…ì…ë‹ˆê¹Œ?", answer:["42360ëª…","42,360ëª…","42360","ì‚¬ë§Œì´ì²œì‚¼ë°±ìœ¡ì‹­"], ref:"ì— 2:64" },
        { category:"ì—ìŠ¤ë¼", level:"ìƒ", type:"subjective", question:"ì„±ì „ ë´‰í—Œì‹ ë•Œ ì´ìŠ¤ë¼ì—˜ ì „ì²´ ì§€íŒŒ ìˆ˜ë¥¼ ë”°ë¼ ì†ì£„ì œë¡œ ë“œë¦° ìˆ˜ì—¼ì†ŒëŠ” ëª‡ ë§ˆë¦¬?", answer:["12","12ë§ˆë¦¬","ì‹­ì´","ì—´ë‘"], ref:"ì— 6:17" },
        { category:"ì—ìŠ¤ë¼", level:"ìƒ", type:"objective", question:"ì—ìŠ¤ë¼ê°€ 'ê°€ì‹œë±Œ' ì§€ë°©ìœ¼ë¡œ ì‚¬ëŒì„ ë³´ë‚´ ë°ë ¤ì˜¨ 'ëª…ì² í•œ ì‚¬ëŒ'ì˜ ì´ë¦„ì€?", options:["ì„¸ë ˆë±Œ","ë„ë¹„ì•¼","ì‚°ë°œë","ê²Œì…ˆ"], answer:0, ref:"ì— 8:18" },
        { category:"ì—ìŠ¤ë¼", level:"ìƒ", type:"subjective", question:"ì—ìŠ¤ë¼ê°€ ë°”ë²¨ë¡ ì—ì„œ ì¶œë°œí•˜ì—¬ ì˜ˆë£¨ì‚´ë ˜ì— ë„ì°©í•˜ê¸°ê¹Œì§€ ê±¸ë¦° ê¸°ê°„ì€?", answer:["4ê°œì›”","ì‚¬ê°œì›”","ë„‰ ë‹¬"], ref:"ì— 7:9" },

        // â”€â”€ ëŠí—¤ë¯¸ì•¼ (20ë¬¸ì œ) â”€â”€
        // í•˜
        { category:"ëŠí—¤ë¯¸ì•¼", level:"í•˜", type:"subjective", question:"ëŠí—¤ë¯¸ì•¼ê°€ ë°”ì‚¬ ê¶ì—ì„œ ë§¡ì•˜ë˜ ì§ì±…ì€?", answer:["ìˆ  ê´€ì›","ìˆ ê´€ì›","ìˆ  ë§¡ì€ ê´€ì›","ìˆ ì„ ë§¡ì€ ê´€ì›"], ref:"ëŠ 1:11" },
        { category:"ëŠí—¤ë¯¸ì•¼", level:"í•˜", type:"objective", question:"ì˜ˆë£¨ì‚´ë ˜ ì„±ë²½ì´ í—ˆë¬¼ì–´ì¡Œë‹¤ëŠ” ì†Œì‹ì„ ëŠí—¤ë¯¸ì•¼ì—ê²Œ ì „í•´ì¤€ í˜•ì œëŠ”?", options:["í•˜ë‚˜ë‹ˆ","í•˜ë‚˜ëƒ","ì‚°ë°œë","ë„ë¹„ì•¼"], answer:0, ref:"ëŠ 1:2" },
        { category:"ëŠí—¤ë¯¸ì•¼", level:"í•˜", type:"subjective", question:"ëŠí—¤ë¯¸ì•¼ê°€ ì˜ˆë£¨ì‚´ë ˜ ì„±ë²½ ì¬ê±´ì„ ê°€ì¥ ì§‘ìš”í•˜ê²Œ ë°©í•´í–ˆë˜ ë‘ ì¸ë¬¼ì€?", answer:["ì‚°ë°œëê³¼ ë„ë¹„ì•¼","ì‚°ë°œë, ë„ë¹„ì•¼"], ref:"ëŠ 2:10" },
        { category:"ëŠí—¤ë¯¸ì•¼", level:"í•˜", type:"objective", question:"ëŠí—¤ë¯¸ì•¼ì™€ ë°±ì„±ë“¤ì´ ì˜ˆë£¨ì‚´ë ˜ ì„±ë²½ì„ ì™„ê³µí•˜ëŠ” ë° ê±¸ë¦° ì‹œê°„ì€?", options:["40ì¼","52ì¼","70ì¼","120ì¼"], answer:1, ref:"ëŠ 6:15" },
        { category:"ëŠí—¤ë¯¸ì•¼", level:"í•˜", type:"subjective", question:"ì„±ë²½ ì¬ê±´ í›„ í•™ì‚¬ ì—ìŠ¤ë¼ê°€ ìœ¨ë²•ì±…ì„ ë‚­ë…í•  ë•Œ ë°±ì„±ë“¤ì€ ì–´ë””ì— ëª¨ì—¬ ìˆì—ˆìŠµë‹ˆê¹Œ?", answer:["ìˆ˜ë¬¸ ì• ê´‘ì¥","ìˆ˜ë¬¸ ì•"], ref:"ëŠ 8:1" },
        // ì¤‘
        { category:"ëŠí—¤ë¯¸ì•¼", level:"ì¤‘", type:"objective", question:"ëŠí—¤ë¯¸ì•¼ê°€ ë°¤ì— ëª°ë˜ ì„±ë²½ì„ ì‚´í´ë³¼ ë•Œ íƒ€ê³  ë‚˜ê°„ ê²ƒì€?", options:["ë³‘ê±°","ë‚™íƒ€","ì§ìŠ¹","ìˆ˜ë ˆ"], answer:2, ref:"ëŠ 2:12" },
        { category:"ëŠí—¤ë¯¸ì•¼", level:"ì¤‘", type:"subjective", question:"ëŒ€ì ë“¤ì˜ ìœ„í˜‘ì´ ì‹¬í•´ì§€ì í•œ ì†ì—ëŠ” ì—°ì¥ì„, ë‹¤ë¥¸ í•œ ì†ì—ëŠ” ë¬´ì—‡ì„ ì¡ê²Œ í–ˆìŠµë‹ˆê¹Œ?", answer:["ë³‘ê¸°","ë¬´ê¸°","ì¹¼","ì°½"], ref:"ëŠ 4:17" },
        { category:"ëŠí—¤ë¯¸ì•¼", level:"ì¤‘", type:"objective", question:"ëŠí—¤ë¯¸ì•¼ê°€ ê·€ì¡±ë“¤ê³¼ ë¯¼ì¥ë“¤ì„ ê¾¸ì§–ì–´ íì§€í•˜ê²Œ í•œ ê²ƒì€?", options:["ì„¸ê¸ˆ","ì œì‚¬","ì´ì","ë¶€ì—­"], answer:2, ref:"ëŠ 5:7" },
        { category:"ëŠí—¤ë¯¸ì•¼", level:"ì¤‘", type:"subjective", question:"ì„±ë²½ ë´‰í—Œí•  ë•Œ ì°¬ì–‘í•˜ëŠ” ìë“¤ì´ ë™ì›í•œ ì•…ê¸°ëŠ”?", answer:["ì œê¸ˆ, ë¹„íŒŒ, ìˆ˜ê¸ˆ","ì œê¸ˆ ë¹„íŒŒ ìˆ˜ê¸ˆ"], ref:"ëŠ 12:27" },
        { category:"ëŠí—¤ë¯¸ì•¼", level:"ì¤‘", type:"objective", question:"ì—ìŠ¤ë¼ê°€ ìœ¨ë²•ì±…ì„ í´ì„œ ì½ì„ ë•Œ ëª¨ë“  ë°±ì„±ì´ ì·¨í•œ í–‰ë™ì€?", options:["ì¼ì–´ì„°ë‹¤","ì—ë“œë ¸ë‹¤","ì¶¤ì„ ì·„ë‹¤","í†µê³¡í–ˆë‹¤"], answer:0, ref:"ëŠ 8:5" },
        { category:"ëŠí—¤ë¯¸ì•¼", level:"ì¤‘", type:"subjective", question:"ì–‘ë¬¸ì„ ê±´ì¶•í•˜ê³  ì„±ë³„í•˜ì—¬ ë¬¸ì§ì„ ë‹¨ ì‚¬ëŒì€?", answer:["ì—˜ë¦¬ì•„ì‹­","ëŒ€ì œì‚¬ì¥ ì—˜ë¦¬ì•„ì‹­"], ref:"ëŠ 3:1" },
        { category:"ëŠí—¤ë¯¸ì•¼", level:"ì¤‘", type:"objective", question:"ì‚°ë°œëê³¼ ë„ë¹„ì•¼ê°€ ëŠí—¤ë¯¸ì•¼ë¥¼ ìœ ì¸í•˜ê¸° ìœ„í•´ ë§Œë‚˜ìê³  ì œì•ˆí•œ ê³³ì€?", options:["ì—¬ë¦¬ê³  í‰ì§€","ì˜¤ë…¸ í‰ì§€","ê¸°ë“œë¡  ê³¨ì§œê¸°","íŒë†ˆì˜ ê³¨ì§œê¸°"], answer:1, ref:"ëŠ 6:2" },
        { category:"ëŠí—¤ë¯¸ì•¼", level:"ì¤‘", type:"subjective", question:"ì„±ë²½ ì™„ê³µ í›„ ì˜ˆë£¨ì‚´ë ˜ ì„±ì•ˆì— ê±°ì£¼í•  ì‚¬ëŒì„ ì •í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œ ë°©ë²•ì€?", answer:["ì œë¹„ ë½‘ê¸°","ì œë¹„ë½‘ê¸°"], ref:"ëŠ 11:1" },
        { category:"ëŠí—¤ë¯¸ì•¼", level:"ì¤‘", type:"subjective", question:"ëŠí—¤ë¯¸ì•¼ 13ì¥ì—ì„œ ì•ˆì‹ì¼ ì „ë‚  ì–´ë‘ì›Œê°ˆ ë•Œ ëŠí—¤ë¯¸ì•¼ê°€ ë‹«ê²Œ í•œ ê²ƒì€?", answer:["ì„±ë¬¸"], ref:"ëŠ 13:19" },
        { category:"ëŠí—¤ë¯¸ì•¼", level:"ì¤‘", type:"objective", question:"ì„±ë²½ ì¬ê±´ì— ì°¸ì—¬í•œ 'ë“œê³ ì•„ ì‚¬ëŒ'ë“¤ ì¤‘ ê³µì‚¬ë¥¼ ë¶„ë‹´í•˜ì§€ ì•Šì€ ìë“¤ì€?", options:["ë¶€ì¸ë“¤","ìë…€ë“¤","ì¢…ë“¤","ê·€ì¡±ë“¤"], answer:3, ref:"ëŠ 3:5" },
        // ìƒ
        { category:"ëŠí—¤ë¯¸ì•¼", level:"ìƒ", type:"subjective", question:"ëŠí—¤ë¯¸ì•¼ê°€ ì˜ˆë£¨ì‚´ë ˜ì˜ ì†Œì‹ì„ ì²˜ìŒ ë“¤ì—ˆì„ ë•Œì˜ ì •í™•í•œ ì‹œê¸°ëŠ”?", answer:["ì•„ë‹¥ì‚¬ìŠ¤ë‹¤ ì™• ì œì´ì‹­ë…„ ê¸°ìŠ¬ë˜ì›”","ê¸°ìŠ¬ë˜ì›”"], ref:"ëŠ 1:1" },
        { category:"ëŠí—¤ë¯¸ì•¼", level:"ìƒ", type:"objective", question:"ëŠí—¤ë¯¸ì•¼ê°€ ìœ ë‹¤ ì´ë…ìœ¼ë¡œ ì‚¬ì—­í•œ ì²« ë²ˆì§¸ ê¸°ê°„ì€ ì´ ëª‡ ë…„ì…ë‹ˆê¹Œ?", options:["5ë…„","7ë…„","10ë…„","12ë…„"], answer:3, ref:"ëŠ 5:14" },
        { category:"ëŠí—¤ë¯¸ì•¼", level:"ìƒ", type:"subjective", question:"ë„ë¹„ì•¼ê°€ 'ê·¸ë“¤ì´ ê±´ì¶•í•˜ëŠ” ëŒ ì„±ë²½ì€ ( )ê°€ ì˜¬ë¼ê°€ë„ ê³§ ë¬´ë„ˆì§€ë¦¬ë¼'ê³  ì¡°ë¡±í–ˆìŠµë‹ˆë‹¤. ê´„í˜¸ ì•ˆì˜ ë™ë¬¼ì€?", answer:["ì—¬ìš°"], ref:"ëŠ 4:3" },
        { category:"ëŠí—¤ë¯¸ì•¼", level:"ìƒ", type:"objective", question:"ì„±ë²½ì´ ì™„ê³µëœ êµ¬ì²´ì  ë‚ ì§œëŠ”?", options:["ì—˜ë£°ì›” ì´ì‹­ì˜¤ì¼","ê¸°ìŠ¬ë˜ì›” ì´ˆí•˜ë£¨","ë‹ˆì‚°ì›” ì‹­ì‚¬ì¼","ì•„ë‹¬ì›” ì‚¼ì¼"], answer:0, ref:"ëŠ 6:15" },
        { category:"ëŠí—¤ë¯¸ì•¼", level:"ìƒ", type:"subjective", question:"ëŠí—¤ë¯¸ì•¼ 13ì¥ì—ì„œ ëŠí—¤ë¯¸ì•¼ê°€ ë°”ì‚¬ë¡œ ëŒì•„ê°„ ì‚¬ì´ ëŒ€ì œì‚¬ì¥ ì—˜ë¦¬ì•„ì‹­ì´ ì„±ì „ì— ë°©ì„ ë§Œë“¤ì–´ ì¤€ ëŒ€ì ì€?", answer:["ë„ë¹„ì•¼"], ref:"ëŠ 13:4-5" }
    ];

    // ë¬¸ì œ ì…”í”Œ í•¨ìˆ˜ (Fisher-Yates)
    function shuffleArray(arr) {
        const shuffled = [...arr];
        for (let i = shuffled.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
        }
        return shuffled;
    }

    let shuffledQuiz = [];
    let currentQuestionIndex = 0;
    let score = 0;
    let lives = 3;
    let streak = 0;
    let isAnswering = true;
    let playerName = '';
    let playerGroup = '';
    let previousScore = null;
    let rivalData = [];
    let timer = null;
    let timeLeft = 0;
    let currentCorrectIndex = 0;
    let currentShuffledOptions = [];
    const TIME_LIMITS = { 'objective': 20, 'subjective': 30 };

    const startScreen = document.getElementById('start-screen');
    const registerScreen = document.getElementById('register-screen');
    const quizScreen = document.getElementById('quiz-screen');
    const resultScreen = document.getElementById('result-screen');
    const leaderboardScreen = document.getElementById('leaderboard-screen');
    const gameoverScreen = document.getElementById('gameover-screen');
    const questionEl = document.getElementById('question');
    const optionsContainer = document.getElementById('options-container');
    const inputContainer = document.getElementById('input-container');
    const badgeEl = document.getElementById('category-badge');
    const progressBar = document.getElementById('progress');
    const feedbackEl = document.getElementById('feedback');

    // ì£¼ê´€ì‹ Enterí‚¤ ì œì¶œ
    document.getElementById('subjective-answer').addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
            e.preventDefault();
            submitSubjective();
        }
    });

    // ì°¸ê°€ì ë“±ë¡ í™”ë©´ì—ì„œ Enterí‚¤ë¡œ í€´ì¦ˆ ì‹œì‘
    document.getElementById('input-name').addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
            e.preventDefault();
            startQuiz();
        }
    });

    function hideAllScreens() {
        [startScreen, registerScreen, quizScreen, resultScreen, leaderboardScreen, gameoverScreen]
            .forEach(s => s.classList.add('hidden'));
    }

    // â”€â”€â”€ ë’¤ë¡œê°€ê¸° íˆìŠ¤í† ë¦¬ ê´€ë¦¬ â”€â”€â”€
    let currentScreen = 'start';
    function pushScreen(name) {
        if (currentScreen !== name) {
            currentScreen = name;
            history.pushState({ screen: name }, '');
        }
    }
    window.addEventListener('popstate', function(e) {
        const screen = e.state && e.state.screen ? e.state.screen : 'start';
        currentScreen = screen;
        // í€´ì¦ˆ ì¤‘ ë’¤ë¡œê°€ê¸° ì‹œ íƒ€ì´ë¨¸ ì •ë¦¬
        if (screen !== 'quiz') {
            clearInterval(timer);
        }
        switch (screen) {
            case 'register': showRegister(true); break;
            case 'quiz': break; // í€´ì¦ˆ ì¤‘ì—ëŠ” ë’¤ë¡œê°€ê¸° ë¬´ì‹œ
            case 'result': break; // ê²°ê³¼ í™”ë©´ì€ ë‹¤ì‹œ ëª» ëŒì•„ê°
            case 'gameover': break;
            case 'leaderboard': showLeaderboard(true); break;
            default: showStart(true); break;
        }
    });
    // ì´ˆê¸° ìƒíƒœ ì €ì¥
    history.replaceState({ screen: 'start' }, '');

    // â”€â”€â”€ í”¼ë“œë°± ë©”ì‹œì§€ ë°”ë¦¬ì—ì´ì…˜ â”€â”€â”€
    const correctMessages = [
        "ì •ë‹µ! ğŸ‘", "ë§ì•˜ìŠµë‹ˆë‹¤! âœ¨", "ì •í™•í•´ìš”! ğŸ‘", "í›Œë¥­í•©ë‹ˆë‹¤! ğŸŒŸ",
        "ëŒ€ë‹¨í•´ìš”! ğŸ’¯", "ì™„ë²½í•´ìš”! â­", "ë°”ë¡œ ê·¸ê±°ì˜ˆìš”! ğŸ¯", "ì—­ì‹œ ì‹¤ë ¥ì! ğŸ’ª",
        "ì„±ê²½ ë°•ì‚¬ì‹œë„¤ìš”! ğŸ“–", "ë†€ë¼ìš´ ì§€ì‹ì´ì—ìš”! ğŸ§ ", "í•˜ë‚˜ë‹˜ ë§ì”€ì„ ì˜ ì•„ì‹œë„¤ìš”! âœï¸",
        "ì€í˜œë¡œìš´ ì •ë‹µ! ğŸ™", "ë©‹ì ¸ìš”! ğŸ‰", "ë¹™ê³ ! ì •ë‹µ! ğŸ””", "ì²™ì²™ ë§ì¶”ì‹œë„¤ìš”! ğŸ˜",
        "ê°íƒ„ì´ ë‚˜ì˜µë‹ˆë‹¤! ğŸ‘", "ë§ì”€ ë¬µìƒì˜ ì—´ë§¤ë„¤ìš”! ğŸŒ¿", "ì§€í˜œê°€ ë„˜ì¹˜ì‹œë„¤ìš”! ğŸ“œ",
        "ìš°ì™€, ëŒ€ë‹¨í•©ë‹ˆë‹¤! ğŸ¤©", "ë§ì•˜ì–´ìš”! ì´ ê¸°ì„¸ë¡œ! ğŸš€",
        "ì²œì¬ ì•„ë‹Œê°€ìš”?! ğŸ§‘â€ğŸ“", "ì´ê±´ ì¢€ ì•„ëŠ” ì‚¬ëŒì´ë„¤ìš”! ğŸ¤“",
        "ì„±ê²½ í€´ì¦ˆì™• ë“±ê·¹! ğŸ‘‘", "ê°íˆ ì´ê±¸ ë§ì¶”ë‹¤ë‹ˆ! ğŸ†",
        "ì‹ ì˜ í•œ ìˆ˜! â™Ÿï¸", "ë§ì”€ì´ ë§ˆìŒì— ìƒˆê²¨ì ¸ ìˆêµ°ìš”! ğŸ’",
        "QTì˜ í˜ì´ ëŠê»´ì§‘ë‹ˆë‹¤! ğŸ“•", "ì£¼ì¼í•™êµ ì„ ìƒë‹˜ í•˜ì…”ë„ ë˜ê² ì–´ìš”! ğŸ’",
        "ì˜¤ëŠ˜ì˜ MVP! ğŸ¥‡", "ì´ ì •ë„ë©´ ëª©ì‚¬ë‹˜ê¸‰! â›ª",
        "ì„±ê²½í†µë… ëª‡ ë²ˆ í•˜ì‹  ê±°ì˜ˆìš”?! ğŸ“š", "í• ë ë£¨ì•¼! ì •ë‹µ! ğŸ¶",
        "ì•„ë©˜! ë§ì•˜ìŠµë‹ˆë‹¤! ğŸ™Œ", "ì™€ ì§„ì§œ ì˜í•˜ì‹œë„¤ìš”! ğŸ«¢",
        "ì´ ë¬¸ì œ ì–´ë ¤ì› ëŠ”ë°... ëŒ€ë‹¨í•´ìš”! ğŸ˜²", "ì„¤ë§ˆ ë‹¤ ì™¸ìš°ì‹  ê±´ ì•„ë‹ˆì£ ?! ğŸ¤­",
        "ì •ë‹µì˜ ë‹¬ì¸! ğŸª", "ì—­ì‹œ ë¯¿ìŒì˜ ì‚¬ëŒ! âœ¨", "í˜¹ì‹œ ì‹ í•™ê³¼?! ğŸ“",
        "ëê¹Œì§€ ì§‘ì¤‘í•˜ì‹œë„¤ìš”! ğŸ”¥",
    ];

    const correctBibleVerses = [
        "\"ì§€í˜œì˜ ê·¼ë³¸ì€ ì—¬í˜¸ì™€ë¥¼ ê²½ì™¸í•˜ëŠ” ê²ƒì´ë¼\" (ì  9:10)",
        "\"ë„¤ ë§ˆìŒì„ ë‹¤í•˜ì—¬ ì—¬í˜¸ì™€ë¥¼ ì‹ ë¢°í•˜ë¼\" (ì  3:5)",
        "\"í•­ìƒ ê¸°ë»í•˜ë¼\" (ì‚´ì „ 5:16)",
        "\"ì‰¬ì§€ ë§ê³  ê¸°ë„í•˜ë¼\" (ì‚´ì „ 5:17)",
        "\"ë²”ì‚¬ì— ê°ì‚¬í•˜ë¼\" (ì‚´ì „ 5:18)",
        "\"ì—¬í˜¸ì™€ëŠ” ë‚˜ì˜ ëª©ìì‹œë‹ˆ ë‚´ê²Œ ë¶€ì¡±í•¨ì´ ì—†ìœ¼ë¦¬ë¡œë‹¤\" (ì‹œ 23:1)",
        "\"ë‚´ê°€ ë„ˆí¬ì—ê²Œ í‰ì•ˆì„ ë¼ì¹˜ë…¸ë¼\" (ìš” 14:27)",
        "\"ë‘ë ¤ì›Œí•˜ì§€ ë§ë¼ ë‚´ê°€ ë„ˆì™€ í•¨ê»˜ í•¨ì´ë¼\" (ì‚¬ 41:10)",
        "\"ë‚˜ì˜ ì€í˜œê°€ ë„¤ê²Œ ì¡±í•˜ë„ë‹¤\" (ê³ í›„ 12:9)",
        "\"ëª¨ë“  ì§€ê°ì— ë›°ì–´ë‚œ í•˜ë‚˜ë‹˜ì˜ í‰ê°•ì´ ë„ˆí¬ë¥¼ ì§€í‚¤ì‹œë¦¬ë¼\" (ë¹Œ 4:7)",
        "\"ì—¬í˜¸ì™€ë¥¼ ê¸°ë»í•˜ë¼ ê·¸ê°€ ë„¤ ë§ˆìŒì˜ ì†Œì›ì„ ì´ë£¨ì–´ ì£¼ì‹œë¦¬ë¡œë‹¤\" (ì‹œ 37:4)",
        "\"ë‚´ê°€ ì„¸ìƒ ëë‚ ê¹Œì§€ ë„ˆí¬ì™€ í•­ìƒ í•¨ê»˜ ìˆìœ¼ë¦¬ë¼\" (ë§ˆ 28:20)",
        "\"ì‚¬ë‘ì€ ì˜¤ë˜ ì°¸ê³  ì˜¨ìœ í•˜ë©°\" (ê³ ì „ 13:4)",
        "\"ê°ì‚¬í•¨ìœ¼ë¡œ ê·¸ ë¬¸ì— ë“¤ì–´ê°€ë©° ì°¬ì†¡í•¨ìœ¼ë¡œ ê·¸ ê¶ì •ì— ë“¤ì–´ê°€ë¼\" (ì‹œ 100:4)",
        "\"ì—¬í˜¸ì™€ëŠ” ë‚˜ì˜ ë¹›ì´ìš” ë‚˜ì˜ êµ¬ì›ì´ì‹œë¼\" (ì‹œ 27:1)",
        "\"ë„ˆëŠ” ë‚´ê²Œ ë¶€ë¥´ì§–ìœ¼ë¼ ë‚´ê°€ ë„¤ê²Œ ì‘ë‹µí•˜ê² ê³ \" (ë ˜ 33:3)",
        "\"ì—¬í˜¸ì™€ì˜ ë§ì”€ì€ ìˆœì „í•˜ì—¬ ì€ê°™ì´ ë¹›ë‚˜ë„ë‹¤\" (ì‹œ 12:6)",
        "\"ì£¼ì˜ ë§ì”€ì€ ë‚´ ë°œì— ë“±ì´ìš” ë‚´ ê¸¸ì— ë¹›ì´ë‹ˆì´ë‹¤\" (ì‹œ 119:105)",
        "\"í•  ìˆ˜ ìˆê±°ë“ ì´ ë¬´ìŠ¨ ë§ì´ëƒ ë¯¿ëŠ” ìì—ê²ŒëŠ” ëŠ¥íˆ í•˜ì§€ ëª»í•  ì¼ì´ ì—†ëŠë‹ˆë¼\" (ë§‰ 9:23)",
        "\"í•˜ë‚˜ë‹˜ì´ ì„¸ìƒì„ ì´ì²˜ëŸ¼ ì‚¬ë‘í•˜ì‚¬\" (ìš” 3:16)",
    ];

    const wrongMessages = [
        "ì•„ì‰½ë„¤ìš”! ğŸ˜…", "ì•„ê¹ë‹¤! ë‹¤ìŒì—” ë§ì¶°ë´ìš”! ğŸ’ª", "ì•„ì°¨! ğŸ˜®",
        "ê´œì°®ì•„ìš”, ë‹¤ìŒ ê¸°íšŒê°€ ìˆì–´ìš”! ğŸ™‚", "í‹€ë ¸ì§€ë§Œ ë°°ì›€ì´ ìˆì–´ìš”! ğŸ“š",
        "ì´ëŸ°! ì•„ì‰¬ì›Œìš”! ğŸ˜¥", "ë‹¤ìŒì—” ê¼­ ë§ì¶œ ìˆ˜ ìˆì–´ìš”! ğŸ’ª",
        "ì‹¤ìˆ˜ëŠ” ì„±ì¥ì˜ ê¸°íšŒì˜ˆìš”! ğŸŒ±", "í•œ ë²ˆ ë” ê¸°ì–µí•´ë´ìš”! ğŸ§ ",
        "ê°€ê¹Œì› ì–´ìš”! ì¡°ê¸ˆë§Œ ë”! ğŸ‘Š", "ì•„ì‰½ì§€ë§Œ í¬ê¸°í•˜ì§€ ë§ˆì„¸ìš”! ğŸ”¥",
        "ì´ê²ƒë„ í•˜ë‚˜ì˜ ë°°ì›€ì´ì—ìš”! âœï¸", "ë‹¤ìŒì—” ë¶„ëª… ë§ì¶œ ê±°ì˜ˆìš”! â­",
        "ì˜¤ë‹µë„ ì‹¤ë ¥ì˜ ì¼ë¶€! ğŸ“ˆ", "ë§ì”€ì„ ë” ë¬µìƒí•´ë´ìš”! ğŸ“–",
        "ì´ë²ˆ ê¸°íšŒë¡œ ê¸°ì–µí•´ë‘ì„¸ìš”! ğŸ’¡", "ê´œì°®ì•„ìš”! ëê¹Œì§€ í™”ì´íŒ…! ğŸƒ",
        "ë„˜ì–´ì ¸ë„ ë‹¤ì‹œ ì¼ì–´ë‚˜ë©´ ë¼ìš”! ğŸŒˆ", "ì•„ì‰½ë„¤ìš”~ ì •ë‹µì„ í™•ì¸í•´ë´ìš”! ğŸ”",
        "ì˜¤ë‹µ ë…¸íŠ¸ì— ì ì–´ë‘ì„¸ìš”! ğŸ“",
        "ì´ ë¬¸ì œ ì–´ë µê¸´ í–ˆì–´ìš”! ğŸ˜¤", "ëˆ„êµ¬ë‚˜ ì‹¤ìˆ˜í•  ìˆ˜ ìˆì–´ìš”! ğŸ¤—",
        "ë‹¤ìŒ ë¬¸ì œì—ì„œ ë§ŒíšŒí•˜ì„¸ìš”! ğŸ’¨", "ì•„ì‰½ì§€ë§Œ ì¢‹ì€ ê²½í—˜ì´ì—ìš”! ğŸ¯",
        "ì´ì œ ì´ê±´ ì ˆëŒ€ ì•ˆ í‹€ë¦¬ê² ì£ ?! ğŸ˜‰", "ì˜¤íˆë ¤ ê¸°ì–µì— ë” ë‚¨ì„ ê±°ì˜ˆìš”! ğŸ§©",
        "ì´ëŸ° ë¬¸ì œë„ ìˆì—ˆêµ°ìš”! ğŸ“Œ", "ê³µë¶€ê°€ ëë‹¤ê³  ìƒê°í•˜ë©´ ë¼ìš”! ğŸ¤“",
        "ë‹¤ìŒì— ë˜ ë‚˜ì˜¤ë©´ ë¬´ì¡°ê±´ ë§ì¶°ìš”! âœŠ", "ì•„ì§ ê¸°íšŒëŠ” ë‚¨ì•„ìˆì–´ìš”! ğŸŒ¤ï¸",
        "ëê¹Œì§€ ì§‘ì¤‘! ë§ŒíšŒí•  ìˆ˜ ìˆì–´ìš”! ğŸ”‹", "ì´ê±´ ì¢€ ì–´ë ¤ì› ì£ ? ê´œì°®ì•„ìš”! ğŸ˜Š",
        "í”ë“¤ë¦¬ì§€ ë§ˆì„¸ìš”! ì•„ì§ ê°ˆ ê¸¸ì´ ìˆì–´ìš”! ğŸ›¤ï¸", "ì‹¤ìˆ˜í•´ë„ ê´œì°®ì•„, ë‹¤ì‹œ ë„ì „! ğŸ”„",
        "ì´ëŸ° ê²½í—˜ì´ ì‹¤ë ¥ì„ ë§Œë“¤ì–´ìš”! ğŸ—ï¸", "í¬ê¸°ë€ ì—†ë‹¤! íŒŒì´íŒ…! ğŸ’¥",
        "í•˜ë‚˜ í‹€ë ¸ë‹¤ê³  ë¬´ë„ˆì§€ì§€ ë§ˆì„¸ìš”! ğŸ°", "ë‹¤ìŒ ë¬¸ì œëŠ” ìì‹  ìˆì£ ?! ğŸ˜",
        "ì´ê±´ ë‚˜ì¤‘ì— ë‹¤ì‹œ ë³µìŠµ! ğŸ”", "í‹€ë¦° ë§Œí¼ ë” ê°•í•´ì ¸ìš”! ğŸ’ª",
    ];

    const wrongBibleVerses = [
        "\"ë„˜ì–´ì§€ë”ë¼ë„ ì•„ì£¼ ì—ì–´ì§€ì§€ ì•„ë‹ˆí•¨ì€ ì—¬í˜¸ì™€ê»˜ì„œ ë¶™ë“œì‹¬ì´ë¡œë‹¤\" (ì‹œ 37:24)",
        "\"ë‚´ê°€ ì•½í•œ ê·¸ ë•Œì— ê°•í•¨ì´ë¼\" (ê³ í›„ 12:10)",
        "\"ëˆˆë¬¼ì„ í˜ë¦¬ë©° ì”¨ë¥¼ ë¿Œë¦¬ëŠ” ìëŠ” ê¸°ì¨ìœ¼ë¡œ ê±°ë‘ë¦¬ë¡œë‹¤\" (ì‹œ 126:5)",
        "\"ì¸ë‚´ë¥¼ ì˜¨ì „íˆ ì´ë£¨ë¼\" (ì•½ 1:4)",
        "\"í”¼ê³¤í•œ ìì—ê²ŒëŠ” ëŠ¥ë ¥ì„ ì£¼ì‹œë©°\" (ì‚¬ 40:29)",
        "\"ì—¬í˜¸ì™€ë¥¼ ì•™ë§í•˜ëŠ” ìëŠ” ìƒˆ í˜ì„ ì–»ìœ¼ë¦¬ë‹ˆ\" (ì‚¬ 40:31)",
        "\"í™˜ë‚œì€ ì¸ë‚´ë¥¼, ì¸ë‚´ëŠ” ì—°ë‹¨ì„, ì—°ë‹¨ì€ ì†Œë§ì„ ì´ë£¨ëŠ” ì¤„ ì•ì´ë¡œë‹¤\" (ë¡¬ 5:3-4)",
        "\"ì„ ì„ í–‰í•˜ë˜ ë‚™ì‹¬í•˜ì§€ ë§ì§€ë‹ˆ\" (ê°ˆ 6:9)",
        "\"ìš°ë¦¬ê°€ ì„ ì„ í–‰í•˜ë˜ ë‚™ì‹¬í•˜ì§€ ë§ì§€ë‹ˆ í¬ê¸°í•˜ì§€ ì•„ë‹ˆí•˜ë©´ ë•Œê°€ ì´ë¥´ë§¤ ê±°ë‘ë¦¬ë¼\" (ê°ˆ 6:9)",
        "\"ë‚˜ë¥¼ ê°•í•˜ê²Œ í•˜ì‹  ì´ ì•ˆì—ì„œ ë‚´ê°€ ëª¨ë“  ê²ƒì„ í•  ìˆ˜ ìˆëŠë‹ˆë¼\" (ë¹Œ 4:13)",
        "\"ìˆ˜ê³ í•˜ê³  ë¬´ê±°ìš´ ì§ ì§„ ìë“¤ì•„ ë‹¤ ë‚´ê²Œë¡œ ì˜¤ë¼ ë‚´ê°€ ë„ˆí¬ë¥¼ ì‰¬ê²Œ í•˜ë¦¬ë¼\" (ë§ˆ 11:28)",
        "\"ì´ ëª¨ë“  ì¼ì— ìš°ë¦¬ë¥¼ ì‚¬ë‘í•˜ì‹œëŠ” ì´ë¡œ ë§ë¯¸ì•”ì•„ ë„‰ë„‰íˆ ì´ê¸°ëŠë‹ˆë¼\" (ë¡¬ 8:37)",
        "\"ë‚˜ì˜ ê³„íšì€ í‰ì•ˆì´ìš” ì¬ì•™ì´ ì•„ë‹ˆë‹ˆë¼\" (ë ˜ 29:11)",
        "\"ë‘ë ¤ì›Œí•˜ì§€ ë§ë¼ ë‚´ê°€ ë„ˆë¥¼ êµ¬ì†í•˜ì˜€ê³  ë„ˆë¥¼ ì§€ëª…í•˜ì—¬ ë¶ˆë €ë‚˜ë‹ˆ\" (ì‚¬ 43:1)",
        "\"ì˜ì¸ì€ ë„˜ì–´ì§ˆì§€ë¼ë„ ë‹¤ì‹œ ì¼ì–´ë‚˜ë ¤ë‹ˆì™€\" (ì  24:16)",
    ];

    const timeUpMessages = [
        "ì‹œê°„ ì´ˆê³¼! â°", "ì‹œê°„ì´ ë‹¤ ëì–´ìš”! â³",
        "ì‹œê°„ ì˜¤ë²„! ì¡°ê¸ˆë§Œ ë” ë¹¨ëìœ¼ë©´! ğŸ˜…", "ì•—, ì‹œê°„ì´! â±ï¸",
        "ì‹œê°„ ì´ˆê³¼! ë‹¤ìŒì—” ë” ë¹ ë¥´ê²Œ! ğŸ’¨", "ì•„ì‰½ê²Œ ì‹œê°„ì´ ì§€ë‚¬ì–´ìš”! âŒ›",
        "ì¡°ê¸ˆë§Œ ë” ë¹¨ëìœ¼ë©´! ğŸƒ", "ì‹œê°„ ì´ˆê³¼! ì„œë‘ë¥´ì„¸ìš”! âš¡",
        "íƒ€ì„ì•„ì›ƒ! ë‹¤ìŒì—” íŒŒì´íŒ…! ğŸ””", "ì‹œê°„ì´ ë¶€ì¡±í–ˆë„¤ìš”! â°",
        "ì‹œê°„ê³¼ì˜ ì‹¸ì›€ì—ì„œ ì¡Œì–´ìš”! ğŸ¥Š", "0.1ì´ˆë§Œ ë” ìˆì—ˆìœ¼ë©´! ğŸ’¦",
        "ì‹œê°„ì•„ ì ê¹ë§Œ! â°", "ì§¸ê¹ì§¸ê¹... ì‹œê°„ ì¢…ë£Œ! ğŸ•",
        "ë¹¨ë¦¬ë¹¨ë¦¬! ë‹¤ìŒì—” ì†ë„ë¥¼! ğŸï¸", "íƒ€ì´ë¨¸ê°€ ë„ˆë¬´ ë¹¨ë¼ìš”! ğŸ˜µâ€ğŸ’«",
        "ì•„ì‰½ë‹¤! ì‹œê°„ë§Œ ì¢€ ë” ìˆì—ˆìœ¼ë©´! ğŸ™ƒ", "ì‹œê°„ ì´ˆê³¼! ê·¸ë˜ë„ í™”ì´íŒ…! ğŸ’ª",
        "ì´‰ë°•í–ˆë„¤ìš”! ë‹¤ìŒì—” ìì‹ ìˆê²Œ! ğŸ¹", "ì‹œê°„ì´ ì ì´ì—ˆë„¤ìš”! ğŸ˜¤",
    ];

    // â”€â”€â”€ ê¸°ë¡ ê²½ì‹  ì¶”ì  â”€â”€â”€
    let recordBroken = false; // ì´ë²ˆ ê²Œì„ì—ì„œ ê¸°ë¡ ê²½ì‹ í–ˆëŠ”ì§€

    function getRecordHint() {
        if (previousScore === null) return null; // ì²« ë„ì „
        if (recordBroken) return null; // ì´ë¯¸ ê²½ì‹ í•¨
        if (score > previousScore) return null; // ì´ë¯¸ ë„˜ì—ˆìŒ

        const remaining = shuffledQuiz.length - currentQuestionIndex;
        const gap = previousScore - score;
        const nextLevel = shuffledQuiz[currentQuestionIndex] ? shuffledQuiz[currentQuestionIndex].level : 'í•˜';
        const minPoints = nextLevel === 'ìƒ' ? 300 : nextLevel === 'ì¤‘' ? 200 : 100;

        // ì´ë²ˆ ë¬¸ì œë§Œ ë§ì¶”ë©´ ê¸°ë¡ ê²½ì‹ 
        if (gap > 0 && gap <= minPoints) {
            return { type: 'one_more', gap: gap };
        }
        // ë‚¨ì€ ë¬¸ì œ ì „ë¶€ ë§ì¶”ë©´ ê¸°ë¡ ê²½ì‹  ê°€ëŠ¥ (ë‚¨ì€ 3ë¬¸ì œ ì´í•˜)
        if (remaining <= 3 && remaining > 0 && gap > 0 && gap <= remaining * 300) {
            return { type: 'close', gap: gap, remaining: remaining };
        }
        // í˜„ì¬ ê¸°ë¡ê³¼ ë™ì 
        if (gap === 0) {
            return { type: 'tied' };
        }
        return null;
    }

    function showRecordHint() {
        const hintEl = document.getElementById('record-hint');
        if (!hintEl) return;

        const hint = getRecordHint();
        if (!hint) {
            // ì´ë¯¸ ê¸°ë¡ ë„˜ì—ˆìœ¼ë©´ ê²½ì‹  ì¤‘ í‘œì‹œ
            if (previousScore !== null && score > previousScore && !recordBroken) {
                recordBroken = true;
                hintEl.innerHTML = 'ğŸ† <b>ê¸°ë¡ ê²½ì‹  ì¤‘!</b> ê³„ì† ë‹¬ë ¤ìš”!';
                hintEl.className = 'record-hint record-breaking';
                return;
            }
            if (recordBroken) {
                const diff = score - previousScore;
                hintEl.innerHTML = `ğŸ† <b>ê¸°ë¡ ê²½ì‹  ì¤‘!</b> +${diff}ì  ì•ì„œëŠ” ì¤‘!`;
                hintEl.className = 'record-hint record-breaking';
                return;
            }
            hintEl.className = 'record-hint hidden';
            return;
        }

        hintEl.className = 'record-hint';
        switch (hint.type) {
            case 'one_more':
                const msgs = [
                    `ğŸ”¥ ì´ê²ƒë§Œ ë§ì¶”ë©´ <b>ê¸°ë¡ ê²½ì‹ !</b> (${hint.gap}ì  ì°¨ì´)`,
                    `âš¡ ê¸°ë¡ê¹Œì§€ ë‹¨ <b>${hint.gap}ì !</b> ì´ë²ˆ ë¬¸ì œê°€ ìŠ¹ë¶€ì²˜!`,
                    `ğŸ¯ ì´ ë¬¸ì œë§Œ ë§ì¶”ë©´ <b>ìƒˆ ì—­ì‚¬!</b> ì§‘ì¤‘!`,
                    `ğŸ’¥ ê¸°ë¡ ê²½ì‹  ëˆˆì•! <b>${hint.gap}ì </b>ë§Œ ë”!`,
                    `ğŸ† ì§€ê¸ˆì´ ì°¬ìŠ¤! ë§ì¶”ë©´ <b>ìµœê³  ê¸°ë¡ ê°±ì‹ !</b>`,
                ];
                hintEl.innerHTML = msgs[Math.floor(Math.random() * msgs.length)];
                hintEl.className = 'record-hint record-close';
                break;
            case 'close':
                const closeMsgs = [
                    `ğŸ“Š ê¸°ë¡ê¹Œì§€ <b>${hint.gap}ì </b> ë‚¨ìŒ! (ë‚¨ì€ ${hint.remaining}ë¬¸ì œ)`,
                    `ğŸ¯ ì•„ì§ ê¸°íšŒ ìˆì–´ìš”! <b>${hint.gap}ì </b>ë§Œ ë” ë”°ë©´ ê¸°ë¡ ê²½ì‹ !`,
                    `ğŸ’ª í¬ê¸°í•˜ì§€ ë§ˆì„¸ìš”! ê¸°ë¡ê¹Œì§€ <b>${hint.gap}ì !</b>`,
                ];
                hintEl.innerHTML = closeMsgs[Math.floor(Math.random() * closeMsgs.length)];
                break;
            case 'tied':
                hintEl.innerHTML = 'âš¡ í˜„ì¬ <b>ìµœê³  ê¸°ë¡ê³¼ ë™ì !</b> í•œ ë¬¸ì œë§Œ ë” ë§ì¶”ë©´ ê²½ì‹ !';
                hintEl.className = 'record-hint record-close';
                break;
        }
    }

    function getRandomMessage(arr) {
        return arr[Math.floor(Math.random() * arr.length)];
    }

    function getCorrectFeedback(points, streakMsg, ref) {
        // ê¸°ë¡ ê²½ì‹  ìˆœê°„ íŠ¹ë³„ ë©”ì‹œì§€
        if (previousScore !== null && !recordBroken && score > previousScore && score - points <= previousScore) {
            recordBroken = true;
            const recordMsgs = [
                "ğŸ† ê¸°ë¡ ê²½ì‹ !! ìƒˆë¡œìš´ ì—­ì‚¬ë¥¼ ì¼ì–´ìš”!",
                "ğŸ† ìµœê³  ê¸°ë¡ ê°±ì‹ !! ëŒ€ë‹¨í•©ë‹ˆë‹¤!",
                "ğŸ† ë“œë””ì–´ ê¸°ë¡ ëŒíŒŒ!! ì¶•í•˜í•´ìš”!",
                "ğŸ† ìƒˆ ê¸°ë¡ ë‹¬ì„±!! ë©ˆì¶”ì§€ ë§ˆì„¸ìš”!",
                "ğŸ† ìê¸° ìì‹ ì„ ë„˜ì—ˆì–´ìš”!! ìµœê³ !",
                "ğŸ† ê¸°ë¡ ê²½ì‹ ! ì˜¤ëŠ˜ì˜ ì „ì„¤!!",
            ];
            const msg = getRandomMessage(recordMsgs);
            return `<div class="feedback-correct feedback-record">${msg} +${points}ì ${streakMsg} (${ref})<div style="font-size:0.85em; margin-top:2px;">ì´ì „ ê¸°ë¡ ${previousScore}ì  â†’ í˜„ì¬ ${score}ì  (+${score - previousScore}ì )</div></div>`;
        }

        const msg = getRandomMessage(correctMessages);
        // 25% í™•ë¥ ë¡œ ì„±ê²½ êµ¬ì ˆë„ í•¨ê»˜ í‘œì‹œ
        const verse = Math.random() < 0.25 ? `<div style="font-size:0.8em; margin-top:4px; color:#388E3C; font-style:italic;">${getRandomMessage(correctBibleVerses)}</div>` : '';
        return `<div class="feedback-correct">${msg} +${points}ì ${streakMsg} (${ref})${verse}</div>`;
    }

    function getWrongFeedback(correctText, ref) {
        const msg = getRandomMessage(wrongMessages);
        // 25% í™•ë¥ ë¡œ ìœ„ë¡œ ì„±ê²½ êµ¬ì ˆ í‘œì‹œ
        const verse = Math.random() < 0.25 ? `<div style="font-size:0.8em; margin-top:4px; color:#C62828; font-style:italic;">${getRandomMessage(wrongBibleVerses)}</div>` : '';
        return `<div class="feedback-wrong">${msg} ì •ë‹µ: ${correctText} (${ref})${verse}</div>`;
    }

    function getTimeUpFeedback(correctText, ref) {
        const msg = getRandomMessage(timeUpMessages);
        return `<div class="feedback-wrong">${msg} ì •ë‹µ: ${correctText} (${ref})</div>`;
    }

    function updateHUD() {
        const heartsEl = document.getElementById('hud-lives');
        heartsEl.innerHTML = 'â¤ï¸'.repeat(lives) + 'ğŸ–¤'.repeat(3 - lives);
        document.getElementById('hud-score').textContent = `${score}ì `;
        const streakEl = document.getElementById('hud-streak');
        streakEl.textContent = streak >= 2 ? `${streak}ì—°ì† ì •ë‹µ! ğŸ”¥` : '';
    }

    function showScoreFloat(points) {
        const floater = document.createElement('div');
        floater.className = points >= 250 ? 'score-float big' : 'score-float';
        floater.textContent = `+${points}`;
        quizScreen.appendChild(floater);
        setTimeout(() => floater.remove(), 1200);
    }

    function showStreakOverlay(streakCount) {
        const overlay = document.createElement('div');
        overlay.className = 'streak-overlay';
        if (streakCount >= 10) overlay.textContent = `ğŸ”¥ ${streakCount}ì—°ì†!! ì „ì„¤!! ğŸ”¥`;
        else if (streakCount >= 7) overlay.textContent = `ğŸ”¥ ${streakCount}ì—°ì†! ë¯¸ì³¤ë‹¤! ğŸ”¥`;
        else if (streakCount >= 5) overlay.textContent = `ğŸ”¥ ${streakCount}ì—°ì†! ëŒ€ë‹¨í•´ìš”!`;
        else overlay.textContent = `ğŸ”¥ ${streakCount}ì—°ì†!`;
        document.body.appendChild(overlay);
        setTimeout(() => overlay.remove(), 1600);
    }

    function spawnParticles() {
        const emojis = ['ğŸ‰', 'âœ¨', 'â­', 'ğŸŒŸ', 'ğŸ’›', 'ğŸŠ'];
        for (let i = 0; i < 8; i++) {
            const p = document.createElement('div');
            p.className = 'particle';
            p.textContent = emojis[Math.floor(Math.random() * emojis.length)];
            p.style.left = (Math.random() * 80 + 10) + '%';
            p.style.top = (Math.random() * 40 + 30) + '%';
            p.style.animationDelay = (Math.random() * 0.3) + 's';
            p.style.animationDuration = (0.8 + Math.random() * 0.5) + 's';
            document.body.appendChild(p);
            setTimeout(() => p.remove(), 1500);
        }
    }

    function loseLife() {
        lives--;
        const heartsEl = document.getElementById('hud-lives');
        heartsEl.classList.add('shake');
        setTimeout(() => heartsEl.classList.remove('shake'), 500);
        updateHUD();
    }

    function calcPoints(level) {
        const base = level === 'ìƒ' ? 300 : level === 'ì¤‘' ? 200 : 100;
        const streakBonus = streak >= 2 ? Math.min(streak, 10) * 10 : 0;
        return base + streakBonus;
    }

    function startTimer(type) {
        clearInterval(timer);
        const total = TIME_LIMITS[type] || 10;
        timeLeft = total;
        const timerText = document.getElementById('timer-text');
        const timerFill = document.getElementById('timer-fill');

        // ì´ˆê¸° ìƒíƒœ: 100%
        timerFill.style.transition = 'none';
        timerFill.style.width = '100%';
        timerFill.className = 'timer-fill green';
        timerText.textContent = total;
        timerText.className = 'timer-text green';

        // ë‹¤ìŒ í”„ë ˆì„ì—ì„œ ì„ í˜• íŠ¸ëœì§€ì…˜ìœ¼ë¡œ 0%ê¹Œì§€ ì¤„ì´ê¸°
        requestAnimationFrame(() => {
            requestAnimationFrame(() => {
                timerFill.style.transition = `width ${total}s linear, background 0.3s`;
                timerFill.style.width = '0%';
            });
        });

        timer = setInterval(() => {
            timeLeft--;
            timerText.textContent = Math.max(timeLeft, 0);
            const pct = timeLeft / total;
            const color = pct > 0.5 ? 'green' : pct > 0.25 ? 'yellow' : 'red';
            timerText.className = 'timer-text ' + color;
            timerFill.className = 'timer-fill ' + color;
            // ë§ˆì§€ë§‰ 3ì´ˆ ì¹´ìš´íŠ¸ë‹¤ìš´ í„ìŠ¤
            if (timeLeft <= 3 && timeLeft > 0) {
                timerText.classList.add('countdown-pulse');
                setTimeout(() => timerText.classList.remove('countdown-pulse'), 500);
            }
            if (timeLeft <= 0) {
                clearInterval(timer);
                timeUp();
            }
        }, 1000);
    }

    function stopTimer() {
        clearInterval(timer);
        const timerFill = document.getElementById('timer-fill');
        // í˜„ì¬ ìœ„ì¹˜ì—ì„œ ë©ˆì¶”ê¸°
        const currentWidth = timerFill.getBoundingClientRect().width;
        const parentWidth = timerFill.parentElement.getBoundingClientRect().width;
        timerFill.style.transition = 'none';
        timerFill.style.width = (currentWidth / parentWidth * 100) + '%';
    }

    function timeUp() {
        if (!isAnswering) return;
        isAnswering = false;
        const currentData = shuffledQuiz[currentQuestionIndex];
        streak = 0;
        loseLife();
        quizScreen.classList.remove('shake', 'bg-pulse-red');
        void quizScreen.offsetWidth;
        quizScreen.classList.add('shake', 'bg-pulse-red');
        setTimeout(() => quizScreen.classList.remove('shake', 'bg-pulse-red'), 600);

        if (currentData.type === 'objective') {
            const buttons = optionsContainer.getElementsByTagName('button');
            buttons[currentCorrectIndex].style.background = "#d4edda";
            feedbackEl.innerHTML = getTimeUpFeedback(currentShuffledOptions[currentCorrectIndex], currentData.ref);
        } else {
            feedbackEl.innerHTML = getTimeUpFeedback(currentData.answer[0], currentData.ref);
        }

        if (lives <= 0) {
            setTimeout(showGameOver, 1500);
        } else {
            setTimeout(nextQuestion, 2000);
        }
    }

    function showRegister(fromHistory) {
        hideAllScreens();
        registerScreen.classList.remove('hidden');
        registerScreen.classList.add('card-enter');
        setTimeout(() => registerScreen.classList.remove('card-enter'), 400);
        document.getElementById('input-name').focus();
        if (!fromHistory) pushScreen('register');
    }

    function showStart(fromHistory) {
        hideAllScreens();
        startScreen.classList.remove('hidden');
        startScreen.classList.add('card-enter');
        setTimeout(() => startScreen.classList.remove('card-enter'), 400);
        if (!fromHistory) pushScreen('start');
    }

    function showLeaderboard(fromHistory) {
        hideAllScreens();
        leaderboardScreen.classList.remove('hidden');
        leaderboardScreen.classList.add('card-enter');
        setTimeout(() => leaderboardScreen.classList.remove('card-enter'), 400);
        // íƒ­ ì´ˆê¸°í™”
        currentTab = 'individual';
        const tabs = document.querySelectorAll('.tab-btn');
        if (tabs.length >= 2) {
            tabs[0].classList.add('active');
            tabs[1].classList.remove('active');
        }
        document.getElementById('leaderboard-content').classList.remove('hidden');
        document.getElementById('department-content').classList.add('hidden');
        renderLeaderboard();
        if (!fromHistory) pushScreen('leaderboard');
    }

    async function startQuiz() {
        // ì…ë ¥ ê²€ì¦
        const groupInput = document.getElementById('input-group');
        const nameInput = document.getElementById('input-name');
        const errorGroup = document.getElementById('error-group');
        const errorName = document.getElementById('error-name');

        let valid = true;
        errorGroup.style.display = 'none';
        errorName.style.display = 'none';

        if (!groupInput.value) {
            errorGroup.style.display = 'block';
            valid = false;
        }
        if (!nameInput.value.trim()) {
            errorName.style.display = 'block';
            valid = false;
        }
        if (!valid) return;

        playerGroup = groupInput.value;
        playerName = nameInput.value.trim();

        // ì´ì „ ì ìˆ˜ & ë¼ì´ë²Œ ë°ì´í„° ë¯¸ë¦¬ fetch
        try {
            const docId = playerGroup + '_' + playerName;
            const [prevDoc, rivalSnapshot] = await Promise.all([
                db.collection('scores').doc(docId).get(),
                db.collection('scores').orderBy('score', 'desc').limit(20).get()
            ]);

            previousScore = prevDoc.exists ? prevDoc.data().score : null;
            rivalData = rivalSnapshot.docs.map(d => ({
                name: d.data().name,
                score: d.data().score,
                group: d.data().group
            }));
        } catch (e) {
            console.error('ì´ì „ ê¸°ë¡/ë¼ì´ë²Œ ë¡œë“œ ì‹¤íŒ¨:', e);
            previousScore = null;
            rivalData = [];
        }

        hideAllScreens();
        quizScreen.classList.remove('hidden');
        quizScreen.classList.add('card-enter');
        setTimeout(() => quizScreen.classList.remove('card-enter'), 400);
        shuffledQuiz = shuffleArray(quizData);
        currentQuestionIndex = 0;
        score = 0;
        lives = 3;
        streak = 0;
        recordBroken = false;
        updateHUD();
        loadQuestion();
        pushScreen('quiz');
    }

    function loadQuestion() {
        isAnswering = true;
        feedbackEl.innerHTML = "";
        document.getElementById('subjective-answer').value = "";

        const currentData = shuffledQuiz[currentQuestionIndex];

        // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
        const progressPercent = ((currentQuestionIndex) / shuffledQuiz.length) * 100;
        progressBar.style.width = `${progressPercent}%`;

        // ê¸°ë¡ ê²½ì‹  íŒíŠ¸ í‘œì‹œ
        showRecordHint();

        // ë¬¸ì œ ì„¸íŒ… (ì• ë‹ˆë©”ì´ì…˜ ì ìš©)
        badgeEl.textContent = `${currentData.category} | ë‚œì´ë„: ${currentData.level}`;
        questionEl.textContent = `Q${currentQuestionIndex + 1}. ${currentData.question}`;
        questionEl.classList.remove('animate');
        void questionEl.offsetWidth; // reflow trigger
        questionEl.classList.add('animate');
        startTimer(currentData.type);

        // íƒ€ì…ë³„ UI ë¶„ê¸°
        if (currentData.type === 'objective') {
            optionsContainer.classList.remove('hidden');
            inputContainer.classList.add('hidden');
            optionsContainer.innerHTML = '';

            // ë³´ê¸° ìˆœì„œ ì…”í”Œ (ì •ë‹µ í¸ì¤‘ ë°©ì§€)
            const indices = currentData.options.map((_, i) => i);
            const shuffledIndices = shuffleArray(indices);
            currentShuffledOptions = shuffledIndices.map(i => currentData.options[i]);
            currentCorrectIndex = shuffledIndices.indexOf(currentData.answer);

            currentShuffledOptions.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = 'btn btn-option option-enter';
                btn.style.animationDelay = `${index * 0.08}s`;
                btn.textContent = `${index + 1}. ${option}`;
                btn.onclick = () => checkAnswer(index);
                optionsContainer.appendChild(btn);
            });
        } else {
            optionsContainer.classList.add('hidden');
            inputContainer.classList.remove('hidden');
            inputContainer.classList.remove('slide-up');
            void inputContainer.offsetWidth;
            inputContainer.classList.add('slide-up');
        }
    }

    function handleCorrect(currentData) {
        stopTimer();
        streak++;
        const points = calcPoints(currentData.level);
        score += points;
        showScoreFloat(points);
        updateHUD();

        // ì¹´ë“œ í…Œë‘ë¦¬ ì´ˆë¡ í„ìŠ¤
        quizScreen.classList.remove('bg-pulse-green');
        void quizScreen.offsetWidth;
        quizScreen.classList.add('bg-pulse-green');
        setTimeout(() => quizScreen.classList.remove('bg-pulse-green'), 600);

        // HUD ì ìˆ˜ ê¸€ë¡œìš°
        const hudScore = document.getElementById('hud-score');
        hudScore.classList.remove('glow');
        void hudScore.offsetWidth;
        hudScore.classList.add('glow');
        setTimeout(() => hudScore.classList.remove('glow'), 600);

        // ìŠ¤íŠ¸ë¦­ ë§ˆì¼ìŠ¤í†¤ (3, 5, 7, 10 ì—°ì†)
        if ([3, 5, 7, 10].includes(streak)) {
            showStreakOverlay(streak);
            spawnParticles();
        }

        // ìŠ¤íŠ¸ë¦­ HUD ì• ë‹ˆë©”ì´ì…˜
        if (streak >= 2) {
            const streakEl = document.getElementById('hud-streak');
            streakEl.classList.remove('streak-fire');
            void streakEl.offsetWidth;
            streakEl.classList.add('streak-fire');
        }

        const streakMsg = streak >= 2 ? ` (${streak}ì—°ì†! ğŸ”¥)` : '';
        feedbackEl.innerHTML = getCorrectFeedback(points, streakMsg, currentData.ref);

        // ë¼ì´ë²Œ ì²´í¬
        checkRival(points);
    }

    function handleWrong(currentData, correctText) {
        stopTimer();
        streak = 0;
        loseLife();

        // ì¹´ë“œ í”ë“¤ë¦¼ + ë¹¨ê°„ í…Œë‘ë¦¬ í„ìŠ¤
        quizScreen.classList.remove('shake', 'bg-pulse-red');
        void quizScreen.offsetWidth;
        quizScreen.classList.add('shake', 'bg-pulse-red');
        setTimeout(() => quizScreen.classList.remove('shake', 'bg-pulse-red'), 600);

        feedbackEl.innerHTML = getWrongFeedback(correctText, currentData.ref);
    }

    // â”€â”€â”€ ë¼ì´ë²Œ ì²´í¬ â”€â”€â”€
    let rivalToastTimer = null;
    function checkRival(earnedPoints) {
        if (!rivalData.length) return;
        // ë³¸ì¸ ì œì™¸
        const rivals = rivalData.filter(r => !(r.name === playerName && r.group === playerGroup));
        if (!rivals.length) return;

        const prevScore = score - earnedPoints;

        // í˜„ì¬ ì ìˆ˜ë¡œ ì´ˆì›”í•œ ë¼ì´ë²Œ ì°¾ê¸° (ë‚®ì€ ìˆœìœ„ë¶€í„° íƒìƒ‰)
        for (let i = rivals.length - 1; i >= 0; i--) {
            const r = rivals[i];
            if (score >= r.score && prevScore < r.score) {
                const rank = i + 1;
                showRivalToast(`ğŸ”¥ ${r.name}ë‹˜(${rank}ìœ„) ì´ˆì›”! í˜„ì¬ ${rank > 1 ? rank - 1 : 1}ìœ„!`);
                return;
            }
        }

        // ë‹¤ìŒ ë¬¸ì œ ìµœì†Œ ì ìˆ˜(100ì )ë§Œ ë§ì¶”ë©´ ì´ˆì›” ê°€ëŠ¥í•œ ë¼ì´ë²Œ
        for (let i = rivals.length - 1; i >= 0; i--) {
            const r = rivals[i];
            if (r.score > score && r.score <= score + 100) {
                const rank = i + 1;
                showRivalToast(`ğŸ’ª ì´ê²ƒë§Œ ë§ì¶”ë©´ ${r.name}ë‹˜(${rank}ìœ„) ì´ˆì›”!`);
                return;
            }
        }
    }

    function showRivalToast(message) {
        const toast = document.getElementById('rival-toast');
        clearTimeout(rivalToastTimer);
        toast.textContent = message;
        toast.classList.add('show');
        rivalToastTimer = setTimeout(() => {
            toast.classList.remove('show');
        }, 3000);
    }

    // â”€â”€â”€ ì ìˆ˜ ë¹„êµ ë©”ì‹œì§€ ìƒì„± â”€â”€â”€
    function getComparisonHTML(currentScore) {
        if (previousScore === null) {
            return '<div class="score-comparison first">â­ ì²« ë„ì „! ê¸°ë¡ì´ ë“±ë¡ë©ë‹ˆë‹¤!</div>';
        } else if (currentScore > previousScore) {
            const diff = currentScore - previousScore;
            return `<div class="score-comparison up">ğŸ“ˆ ì´ì „ ê¸°ë¡ë³´ë‹¤ +${diff}ì  ì˜¬ëì–´ìš”! ğŸ‰</div>`;
        } else if (currentScore === previousScore) {
            return '<div class="score-comparison same">â¡ï¸ ì´ì „ê³¼ ë™ì¼í•œ ì ìˆ˜ì˜ˆìš”!</div>';
        } else {
            return `<div class="score-comparison down">ğŸ“Š ì´ì „ ê¸°ë¡: ${previousScore}ì  (ìµœê³  ê¸°ë¡ì€ ìœ ì§€ë©ë‹ˆë‹¤)</div>`;
        }
    }

    // ê°ê´€ì‹ ì •ë‹µ í™•ì¸
    function checkAnswer(selectedIndex) {
        if (!isAnswering) return;
        isAnswering = false;

        const currentData = shuffledQuiz[currentQuestionIndex];
        const buttons = optionsContainer.getElementsByTagName('button');

        if (selectedIndex === currentCorrectIndex) {
            buttons[selectedIndex].style.background = "#d4edda";
            buttons[selectedIndex].style.borderColor = "#c3e6cb";
            handleCorrect(currentData);
        } else {
            buttons[selectedIndex].style.background = "#f8d7da";
            buttons[selectedIndex].style.borderColor = "#f5c6cb";
            buttons[currentCorrectIndex].style.background = "#d4edda";
            handleWrong(currentData, currentShuffledOptions[currentCorrectIndex]);
        }

        if (lives <= 0) {
            setTimeout(showGameOver, 1500);
        } else {
            setTimeout(nextQuestion, 2000);
        }
    }

    // í•œêµ­ì–´ ì–´ë¯¸ ë³€í˜• ìƒì„± (ë‹¤â†”ã…/ìŒ)
    function getEndingVariants(str) {
        if (!str) return [str];
        const variants = new Set([str]);
        const H = 0xAC00, isH = c => c >= H && c <= 0xD7A3;
        const trail = c => (c - H) % 28;
        const setT = (c, t) => c - trail(c) + t;
        // ~ë‹¤ â†’ ëª…ì‚¬í˜•
        if (str.endsWith('ë‹¤') && str.length >= 2) {
            const pc = str.charCodeAt(str.length - 2);
            if (isH(pc)) {
                const t = trail(pc);
                if (t === 4) // ã„´ë°›ì¹¨: ì§„ë‹¤â†’ì§
                    variants.add(str.slice(0, -2) + String.fromCharCode(setT(pc, 16)));
                else if (t === 0) // ë°›ì¹¨ì—†ìŒ: í•˜ë‹¤â†’í•¨
                    variants.add(str.slice(0, -2) + String.fromCharCode(setT(pc, 16)));
                else // ê¸°íƒ€ë°›ì¹¨: ìˆë‹¤â†’ìˆìŒ
                    variants.add(str.slice(0, -1) + 'ìŒ');
            }
        }
        // ~ã…ë°›ì¹¨ â†’ ì„œìˆ í˜•
        const lc = str.charCodeAt(str.length - 1);
        if (isH(lc) && trail(lc) === 16) {
            variants.add(str.slice(0, -1) + String.fromCharCode(setT(lc, 0)) + 'ë‹¤');
            variants.add(str.slice(0, -1) + String.fromCharCode(setT(lc, 4)) + 'ë‹¤');
        }
        // ~ìŒ â†’ ì„œìˆ í˜•
        if (str.endsWith('ìŒ') && str.length >= 2) {
            variants.add(str.slice(0, -1) + 'ë‹¤');
        }
        return [...variants];
    }

    // ì£¼ê´€ì‹ ì •ë‹µ í™•ì¸
    function submitSubjective() {
        if (!isAnswering) return;
        isAnswering = false;

        const input = document.getElementById('subjective-answer');
        const userValue = input.value.trim().replace(/\s/g, '');
        const currentData = shuffledQuiz[currentQuestionIndex];
        const isCorrect = currentData.answer.some(ans => {
            const normAns = ans.replace(/\s/g, '');
            // ì–´ë¯¸ ë³€í˜• í¬í•¨ ë¹„êµ
            const ansVars = getEndingVariants(normAns);
            const userVars = getEndingVariants(userValue);
            for (const av of ansVars) {
                for (const uv of userVars) {
                    if (uv === av) return true;
                    if (av.length >= 3 && uv.includes(av)) return true;
                }
            }
            // ì‰¼í‘œë¡œ êµ¬ë¶„ëœ ë‹µì€ ê° ìš”ì†Œë¥¼ ëª¨ë‘ í¬í•¨í•˜ë©´ ì •ë‹µ (ìˆœì„œ ë¬´ê´€)
            if (ans.includes(',')) {
                const parts = ans.split(',').map(p => p.trim().replace(/\s/g, ''));
                if (parts.length > 1 && parts.every(part => userValue.includes(part))) return true;
            }
            // 'ê³¼/ì™€'ë¡œ ì—°ê²°ëœ ë‹µë„ ê° ìš”ì†Œë¥¼ ëª¨ë‘ í¬í•¨í•˜ë©´ ì •ë‹µ (ìˆœì„œ ë¬´ê´€)
            const matchKwa = ans.match(/^(.+?)[ê³¼ì™€](.+)$/);
            if (matchKwa) {
                const parts = [matchKwa[1], matchKwa[2]].map(p => p.trim().replace(/\s/g, ''));
                if (parts[0] && parts[1] && parts.every(part => userValue.includes(part))) return true;
            }
            return false;
        });

        if (isCorrect) {
            handleCorrect(currentData);
        } else {
            handleWrong(currentData, currentData.answer[0]);
        }

        if (lives <= 0) {
            setTimeout(showGameOver, 1500);
        } else {
            setTimeout(nextQuestion, 2000);
        }
    }

    function nextQuestion() {
        currentQuestionIndex++;
        if (currentQuestionIndex < shuffledQuiz.length) {
            loadQuestion();
        } else {
            showResult();
        }
    }

    function showGameOver() {
        // ë¼ì´ë²Œ í† ìŠ¤íŠ¸ ìˆ¨ê¸°ê¸°
        clearTimeout(rivalToastTimer);
        document.getElementById('rival-toast').classList.remove('show');

        hideAllScreens();
        gameoverScreen.classList.remove('hidden');
        gameoverScreen.classList.add('card-enter');
        setTimeout(() => gameoverScreen.classList.remove('card-enter'), 400);

        document.getElementById('gameover-player-info').textContent =
            `${playerGroup} Â· ${playerName}`;

        // ì ìˆ˜ ì¹´ìš´íŠ¸ì—… ì• ë‹ˆë©”ì´ì…˜
        const scoreEl = document.getElementById('gameover-score');
        animateScoreCount(scoreEl, score);

        // ì´ì „ ê¸°ë¡ ë¹„êµ ë©”ì‹œì§€
        setTimeout(() => {
            document.getElementById('gameover-comparison').innerHTML = getComparisonHTML(score);
        }, 1300);

        const msgEl = document.getElementById('gameover-message');
        if (score > 0) msgEl.textContent = "ì•„ê¹ë„¤ìš”! ë‹¤ì‹œ ë„ì „í•´ë³´ì„¸ìš”! ğŸ’ª";
        else msgEl.textContent = "ë‹¤ìŒì—” ë” ì˜í•  ìˆ˜ ìˆì–´ìš”! í™”ì´íŒ…! ğŸ“–";

        saveScore(playerGroup, playerName, score);
        pushScreen('gameover');
    }

    function showResult() {
        // ë¼ì´ë²Œ í† ìŠ¤íŠ¸ ìˆ¨ê¸°ê¸°
        clearTimeout(rivalToastTimer);
        document.getElementById('rival-toast').classList.remove('show');

        hideAllScreens();
        resultScreen.classList.remove('hidden');
        resultScreen.classList.add('card-enter');
        setTimeout(() => resultScreen.classList.remove('card-enter'), 400);

        document.getElementById('result-player-info').textContent =
            `${playerGroup} Â· ${playerName}ë‹˜, ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤!`;

        // ì ìˆ˜ ì¹´ìš´íŠ¸ì—… ì• ë‹ˆë©”ì´ì…˜
        const finalScoreEl = document.getElementById('final-score');
        animateScoreCount(finalScoreEl, score);

        // ì™„ì£¼ ì¶•í•˜ íŒŒí‹°í´
        setTimeout(() => spawnParticles(), 500);
        setTimeout(() => spawnParticles(), 1000);

        // ì´ì „ ê¸°ë¡ ë¹„êµ ë©”ì‹œì§€
        setTimeout(() => {
            document.getElementById('result-comparison').innerHTML = getComparisonHTML(score);
        }, 1300);

        const msgEl = document.getElementById('result-message');
        if (lives === 3) msgEl.textContent = "ì™„ë²½í•©ë‹ˆë‹¤! ëª©ìˆ¨ì„ í•˜ë‚˜ë„ ì•ˆ ìƒì—ˆì–´ìš”! ğŸ‰";
        else if (lives === 2) msgEl.textContent = "í›Œë¥­í•©ë‹ˆë‹¤! ì„±ê²½ ë°•ì‚¬ë‹˜ì´ì‹œë„¤ìš”! âœ¨";
        else msgEl.textContent = "ê°„ì‹ íˆ ì‚´ì•„ë‚¨ì•˜ë„¤ìš”! ëŒ€ë‹¨í•´ìš”! ğŸ™";

        saveScore(playerGroup, playerName, score);
        pushScreen('result');
    }

    // ì ìˆ˜ ì¹´ìš´íŠ¸ì—… ì• ë‹ˆë©”ì´ì…˜
    function animateScoreCount(el, targetScore) {
        let current = 0;
        const duration = 1200;
        const step = Math.max(1, Math.floor(targetScore / (duration / 16)));
        const startTime = performance.now();
        function tick(now) {
            const elapsed = now - startTime;
            const progress = Math.min(elapsed / duration, 1);
            // ease-out cubic
            const eased = 1 - Math.pow(1 - progress, 3);
            current = Math.round(eased * targetScore);
            el.textContent = `${current}ì `;
            if (progress < 1) {
                requestAnimationFrame(tick);
            } else {
                el.textContent = `${targetScore}ì `;
                el.classList.add('celebrate-bounce');
                setTimeout(() => el.classList.remove('celebrate-bounce'), 800);
            }
        }
        if (targetScore > 0) {
            requestAnimationFrame(tick);
        } else {
            el.textContent = `${targetScore}ì `;
        }
    }

    function restartQuiz() {
        // ì´ì „ ë¹„êµ ë©”ì‹œì§€ ì´ˆê¸°í™”
        document.getElementById('gameover-comparison').innerHTML = '';
        document.getElementById('result-comparison').innerHTML = '';
        hideAllScreens();
        registerScreen.classList.remove('hidden');
    }

    function shareResult(type) {
        const answered = currentQuestionIndex + (type === 'result' ? 0 : 1);
        const total = shuffledQuiz.length;

        // ë¶€ì„œì› ìê·¹ ë©˜íŠ¸
        const taunts = [
            `${playerGroup}ì—ì„œ ${score}ì ì„ ë°›ì•˜ìŠµë‹ˆë‹¤! í•¨ê»˜ ë„ì „í•˜ì…”ì„œ ìš°ë¦¬ ë¶€ì„œ ì´ì ì„ ì˜¬ë ¤ë´ìš”!`,
            `${playerGroup} ì—¬ëŸ¬ë¶„, ì €ë„ ë„ì „í•´ë´¤ìŠµë‹ˆë‹¤! ë‹¤ ê°™ì´ ì°¸ì—¬í•´ì„œ ì¢‹ì€ ê²°ê³¼ ë§Œë“¤ì–´ë´ìš”!`,
            `${playerGroup} ì‹êµ¬ë“¤ ëª¨ë‘ í•¨ê»˜í•´ìš”! ë§ì”€ í€´ì¦ˆë¡œ ì€í˜œë„ ë°›ê³  ë¶€ì„œ ìˆœìœ„ë„ ì˜¬ë ¤ë´ìš”!`,
            `${playerGroup}ì˜ í•œ ì‚¬ëŒìœ¼ë¡œì„œ ${score}ì ì— ë„ì „í–ˆìŠµë‹ˆë‹¤! ì—¬ëŸ¬ë¶„ë„ í•¨ê»˜ ì‘ì›í•´ì£¼ì„¸ìš”!`
        ];
        const taunt = taunts[Math.floor(Math.random() * taunts.length)];

        let shareText = '';
        if (type === 'gameover') {
            shareText = `â›ª ë™ê´‘êµíšŒ 60ì£¼ë…„ ì˜¨ë¼ì¸ ì„±ê²½í€´ì¦ˆëŒ€íšŒ\n\n`
                + `${taunt}\n\n`
                + `ğŸ“– ${playerName} (${playerGroup})\n`
                + `ğŸ’¯ ${score}ì \n`
                + `â¤ï¸ ëª©ìˆ¨ ì†Œì§„ìœ¼ë¡œ ê²Œì„ì˜¤ë²„!\n\n`
                + `ğŸ‘‰ ì—¬ëŸ¬ë¶„ë„ í•¨ê»˜ ë„ì „í•´ë³´ì„¸ìš”!\n`
                + `${location.href}`;
        } else {
            const livesEmoji = 'â¤ï¸'.repeat(lives) + 'ğŸ–¤'.repeat(3 - lives);
            shareText = `â›ª ë™ê´‘êµíšŒ 60ì£¼ë…„ ì˜¨ë¼ì¸ ì„±ê²½í€´ì¦ˆëŒ€íšŒ\n\n`
                + `${taunt}\n\n`
                + `ğŸ“– ${playerName} (${playerGroup})\n`
                + `ğŸ’¯ ${score}ì  | ${livesEmoji}\n`
                + `âœ… ì „ ${total}ë¬¸ì œ ì™„ì£¼!\n\n`
                + `ğŸ‘‰ ì—¬ëŸ¬ë¶„ë„ í•¨ê»˜ ë„ì „í•´ë³´ì„¸ìš”!\n`
                + `${location.href}`;
        }

        if (navigator.share) {
            navigator.share({
                title: 'ë™ê´‘êµíšŒ ì˜¨ë¼ì¸ ì„±ê²½í€´ì¦ˆëŒ€íšŒ ê²°ê³¼',
                text: shareText
            }).catch(() => {});
        } else {
            navigator.clipboard.writeText(shareText).then(() => {
                alert('ê²°ê³¼ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\nì¹´ì¹´ì˜¤í†¡ì´ë‚˜ SNSì— ë¶™ì—¬ë„£ê¸° í•´ì£¼ì„¸ìš”.');
            }).catch(() => {
                prompt('ì•„ë˜ í…ìŠ¤íŠ¸ë¥¼ ë³µì‚¬í•˜ì—¬ ê³µìœ í•˜ì„¸ìš”:', shareText);
            });
        }
    }

    // â”€â”€â”€ ë¦¬ë”ë³´ë“œ (Firestore) â”€â”€â”€
    function esc(str) {
        const d = document.createElement('div');
        d.textContent = str;
        return d.innerHTML;
    }

    function saveScore(group, name, newScore) {
        var docId = group + '_' + name;
        // ì´ì „ ê¸°ë¡ë³´ë‹¤ ë†’ì„ ë•Œë§Œ ë®ì–´ì“°ê¸° (ìµœê³  ê¸°ë¡ ë³´ì¡´)
        if (previousScore !== null && newScore <= previousScore) {
            return;
        }
        db.collection('scores').doc(docId).set({
            group: group,
            name: name,
            score: newScore,
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        }).catch(function(error) {
            console.error('ì ìˆ˜ ì €ì¥ ì‹¤íŒ¨:', error);
        });
    }

    let currentTab = 'individual';

    function switchTab(tab) {
        currentTab = tab;
        const tabs = document.querySelectorAll('.tab-btn');
        tabs[0].classList.toggle('active', tab === 'individual');
        tabs[1].classList.toggle('active', tab === 'department');

        const individualContent = document.getElementById('leaderboard-content');
        const departmentContent = document.getElementById('department-content');

        if (tab === 'individual') {
            individualContent.classList.remove('hidden');
            departmentContent.classList.add('hidden');
        } else {
            individualContent.classList.add('hidden');
            departmentContent.classList.remove('hidden');
            renderDepartmentRanking();
        }
    }

    async function renderDepartmentRanking() {
        const container = document.getElementById('department-content');
        container.innerHTML = '<div class="leaderboard-empty">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>';

        try {
            const snapshot = await db.collection('scores').get();

            if (snapshot.empty) {
                container.innerHTML = '<div class="leaderboard-empty">'
                    + 'ğŸ… ì•„ì§ ì–´ë–¤ ë¶€ì„œë„ ì°¸ì—¬í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤!<br><br>'
                    + '<strong>ìš°ë¦¬ ë¶€ì„œê°€ ì²« ë²ˆì§¸ë¡œ ì´ë¦„ì„ ì˜¬ë ¤ë³¼ê¹Œìš”?</strong><br><br>'
                    + '<span style="font-size:0.85rem; color:#888;">ë¶€ì„œì› ëª¨ë‘ í•¨ê»˜ ì°¸ì—¬í•˜ë©´ ì´ì ì´ ì˜¬ë¼ê°‘ë‹ˆë‹¤!</span>'
                    + '</div>';
                return;
            }

            // ë¶€ì„œë³„ ì§‘ê³„
            const deptMap = {};
            snapshot.docs.forEach(doc => {
                const entry = doc.data();
                const group = entry.group || 'ë¯¸ë¶„ë¥˜';
                if (!deptMap[group]) {
                    deptMap[group] = { totalScore: 0, count: 0, maxScore: 0 };
                }
                deptMap[group].totalScore += entry.score;
                deptMap[group].count += 1;
                if (entry.score > deptMap[group].maxScore) {
                    deptMap[group].maxScore = entry.score;
                }
            });

            // ì´ì  ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
            const sorted = Object.entries(deptMap)
                .map(([name, data]) => ({ name, ...data }))
                .sort((a, b) => b.totalScore - a.totalScore);

            const medals = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰'];
            let html = `<table class="leaderboard-table">
                <thead><tr>
                    <th>ìˆœìœ„</th><th>ë¶€ì„œ</th><th>ì´ì </th><th>ì¸ì›</th><th>ìµœê³ ì </th>
                </tr></thead><tbody>`;

            sorted.forEach((dept, i) => {
                const rankClass = i < 3 ? ` class="rank-${i + 1}"` : '';
                const rankText = i < 3 ? `<span class="medal">${medals[i]}</span>` : (i + 1);
                html += `<tr${rankClass}>
                    <td>${rankText}</td>
                    <td>${esc(dept.name)}</td>
                    <td><strong>${dept.totalScore}ì </strong></td>
                    <td>${dept.count}ëª…</td>
                    <td>${dept.maxScore}ì </td>
                </tr>`;
            });

            html += '</tbody></table>';
            container.innerHTML = html;
        } catch (error) {
            console.error('ë¶€ì„œ ëŒ€í•­ì „ ì¡°íšŒ ì‹¤íŒ¨:', error);
            container.innerHTML = '<div class="leaderboard-empty">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</div>';
        }
    }

    async function renderLeaderboard() {
        const container = document.getElementById('leaderboard-content');
        container.innerHTML = '<div class="leaderboard-empty">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>';

        try {
            const snapshot = await db.collection('scores')
                .orderBy('score', 'desc')
                .limit(20)
                .get();

            if (snapshot.empty) {
                container.innerHTML = '<div class="leaderboard-empty">'
                    + 'ğŸ“– ì•„ì§ ì•„ë¬´ë„ ë„ì „í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤!<br><br>'
                    + 'ğŸ† <strong>1ë“±ì˜ ìë¦¬ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤</strong><br>'
                    + 'ì§€ê¸ˆ ë„ì „í•˜ì‹œë©´ ë°”ë¡œ 1ë“±ì´ì—ìš”!<br><br>'
                    + '<span style="font-size:0.85rem; color:#888;">ìš°ë¦¬ ë¶€ì„œì˜ ì²« ë²ˆì§¸ ì ìˆ˜ë¥¼ ì˜¬ë ¤ì£¼ì„¸ìš”!</span>'
                    + '</div>';
                return;
            }

            const medals = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰'];
            let html = `<table class="leaderboard-table">
                <thead><tr>
                    <th>ìˆœìœ„</th><th>ì†Œì†</th><th>ì´ë¦„</th><th>ì ìˆ˜</th>
                </tr></thead><tbody>`;

            snapshot.docs.forEach((doc, i) => {
                const entry = doc.data();
                const rankClass = i < 3 ? ` class="rank-${i + 1}"` : '';
                const rankText = i < 3 ? `<span class="medal">${medals[i]}</span>` : (i + 1);
                html += `<tr${rankClass}>
                    <td>${rankText}</td>
                    <td>${esc(entry.group)}</td>
                    <td>${esc(entry.name)}</td>
                    <td><strong>${entry.score}ì </strong></td>
                </tr>`;
            });

            html += '</tbody></table>';
            container.innerHTML = html;
        } catch (error) {
            console.error('ë¦¬ë”ë³´ë“œ ì¡°íšŒ ì‹¤íŒ¨:', error);
            container.innerHTML = '<div class="leaderboard-empty">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</div>';
        }
    }
</script>

</body>
</html>